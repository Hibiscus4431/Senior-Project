<!DOCTYPE html>
<html lang="en-US">

<head>
    <link rel="stylesheet" href="teacher_styles.css">
    <script src="https://cdn.jsdelivr.net/npm/html-docx-js/dist/html-docx.js"></script>

    <script>

        // function that grabs the test options from local storage from Generate Test button
        window.onload = function () {
            const testOptions = JSON.parse(localStorage.getItem('testOptions'));
            if (testOptions) {
                document.getElementById('coverPage').textContent = testOptions.coverPage ? 'Yes' : 'No';
                document.getElementById('timeAllowed').textContent = testOptions.timeAllowed;
                document.getElementById('selectedTemplate').textContent = testOptions.selectedTemplate;
                document.getElementById('uploadedImage').textContent = testOptions.uploadedImage ? testOptions.uploadedImage : 'No image uploaded';
            }
        }

        //new fucntion to export the content of the webpage to a word document
        function exportToWord() {
            var content = document.getElementById('content').innerHTML;
            var converted = htmlDocx.asBlob(content);
            var link = document.createElement('a');
            link.href = URL.createObjectURL(converted);
            link.download = 'TestTemplate.docx';
            link.click();
        }

        /*note to self: 
        -when making js function to display questions
            include <br> tags to separate questions and <br> x2 for sections
        -figure out how to make section headings dynamically
        */

        /*note to self:
        -seperate js function to move questions and sections around on html page 
            while also keeping the content inside the id="content" div
        -use drag and drop feature to move questions and sections around
        */
    </script>

</head>

<body>

    <div class="center large-heading">
        <h1>Test Template</h1>
    </div>

    <div class="center large-paragraph" id = "content">
        Questions will be generated here
        <br>
        testing pt 2
    </div>
    <div class="center large-paragraph">
        <p>Test Options:</p>
        <p>Cover Page: <span id="coverPage"></span></p>
        <p>Time Allowed: <span id="timeAllowed"></span></p>
        <p>Selected Template: <span id="selectedTemplate"></span></p>
        <p>Uploaded Image: <span id="uploadedImage"></span></p>
    </div>


    <div class="center large-paragraph">
        <button onclick="exportToWord()">Export to Word</button>
    </div>

</body>

</html>