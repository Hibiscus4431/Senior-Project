(function(e){function t(t){for(var n,l,r=t[0],s=t[1],i=t[2],d=0,b=[];d<r.length;d++)l=r[d],Object.prototype.hasOwnProperty.call(c,l)&&c[l]&&b.push(c[l][0]),c[l]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);u&&u(t);while(b.length)b.shift()();return a.push.apply(a,i||[]),o()}function o(){for(var e,t=0;t<a.length;t++){for(var o=a[t],n=!0,l=1;l<o.length;l++){var s=o[l];0!==c[s]&&(n=!1)}n&&(a.splice(t--,1),e=r(r.s=o[0]))}return e}var n={},c={app:0},a=[];function l(e){return r.p+"js/"+({}[e]||e)+"."+{"chunk-2d0d6e77":"e4320951"}[e]+".js"}function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.e=function(e){var t=[],o=c[e];if(0!==o)if(o)t.push(o[2]);else{var n=new Promise((function(t,n){o=c[e]=[t,n]}));t.push(o[2]=n);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=l(e);var i=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(d);var o=c[e];if(0!==o){if(o){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;i.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",i.name="ChunkLoadError",i.type=n,i.request=a,o[1](i)}c[e]=void 0}};var d=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},r.m=e,r.c=n,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var u=i;a.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"156a":function(e,t,o){},"17af":function(e,t,o){"use strict";o("1eaa")},"1eaa":function(e,t,o){},2143:function(e,t,o){},"2ac8":function(e,t,o){"use strict";o("57ef")},"2cdb":function(e,t,o){"use strict";o("7a00")},"31d1":function(e,t,o){"use strict";o("3641")},3641:function(e,t,o){},"39c0":function(e,t,o){"use strict";o("7e19")},"3f22":function(e,t,o){"use strict";o("aa55")},"4ff5":function(e,t,o){},"50c4":function(e,t,o){"use strict";o("687a")},"56d7":function(e,t,o){"use strict";o.r(t);var n=o("7a23");const c={id:"app"};function a(e,t,o,a,l,r){const s=Object(n["resolveComponent"])("router-view");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",c,[Object(n["createVNode"])(s)])}var l={name:"App",name:"App",mounted(){document.title="Print-A-Test"}},r=(o("c4f7"),o("6b0d")),s=o.n(r);const i=s()(l,[["render",a]]);var d=i,u=o("6605");const b={class:"Welcome-container"},m={class:"button-container"},p={class:"button-container"},h={class:"button-container"};function O(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",b,[Object(n["createElementVNode"])("div",null,[t[3]||(t[3]=Object(n["createElementVNode"])("h1",{class:"center large-heading"}," Welcome to Test Creation Manager",-1)),t[4]||(t[4]=Object(n["createElementVNode"])("div",{class:"center large-paragraph"}," Select the role you are logging in as:",-1)),t[5]||(t[5]=Object(n["createElementVNode"])("br",null,null,-1)),t[6]||(t[6]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("div",m,[Object(n["createVNode"])(r,{to:"/TeacherLog"},{default:Object(n["withCtx"])(()=>t[0]||(t[0]=[Object(n["createElementVNode"])("button",{class:"button"},"Teacher",-1)])),_:1})]),t[7]||(t[7]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("div",p,[Object(n["createVNode"])(r,{to:"/PubLog"},{default:Object(n["withCtx"])(()=>t[1]||(t[1]=[Object(n["createElementVNode"])("button",{class:"button"},"Publisher",-1)])),_:1})]),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("div",h,[Object(n["createVNode"])(r,{to:"/WebmasterLog"},{default:Object(n["withCtx"])(()=>t[2]||(t[2]=[Object(n["createElementVNode"])("button",{class:"button"},"Webmaster",-1)])),_:1})])])])}var j={name:"Welcome"};o("d08e");const N=s()(j,[["render",O],["__scopeId","data-v-13d09d90"]]);var k=N;const g={class:"theme-publisher"},E={class:"top-banner"},V={class:"banner-actions"},y={class:"center large-paragraph",style:{color:"#222"}},w={class:"page-wrapper"},f={class:"button-row"},T={key:0,class:"p_dropdown"},v={class:"p_dropdown-content"},_={key:1};function B(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",g,[Object(n["createElementVNode"])("div",E,[t[1]||(t[1]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Textbook Selection",-1)),Object(n["createElementVNode"])("div",V,[Object(n["createVNode"])(r,{to:"/",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[0]||(t[0]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",y,[Object(n["createElementVNode"])("div",w,[t[5]||(t[5]=Object(n["createTextVNode"])(" Please select or add a textbook: ")),Object(n["createElementVNode"])("div",f,[a.textbooks.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",T,[t[2]||(t[2]=Object(n["createElementVNode"])("button",{class:"p_dropbtn"},"Select Textbook",-1)),Object(n["createElementVNode"])("div",v,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.textbooks,e=>(Object(n["openBlock"])(),Object(n["createBlock"])(r,{key:e.id,to:{path:"PubQuestions",query:{title:e.title,textbook_id:e.id}}},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.title),1)]),_:2},1032,["to"]))),128))])])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",_," No courses available. ")),Object(n["createVNode"])(r,{to:"PubNewBook"},{default:Object(n["withCtx"])(()=>t[3]||(t[3]=[Object(n["createElementVNode"])("button",{class:"p_button"},"Add New Textbook",-1)])),_:1}),t[4]||(t[4]=Object(n["createElementVNode"])("br",null,null,-1))])])])])}var x=o("cee4");const C=x["a"].create({baseURL:"http://127.0.0.1:5000",responseType:"json"});async function S(){const e=localStorage.getItem("token");if(!e)return null;try{const t=await x["a"].post("http://127.0.0.1:5000/auth/refresh",{token:e}),o=t.data.token;return localStorage.setItem("token",o),o}catch(t){return console.error("Token refresh failed:",t),localStorage.removeItem("token"),localStorage.removeItem("user_id"),localStorage.removeItem("role"),null}}C.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer "+t),e},e=>Promise.reject(e)),C.interceptors.response.use(e=>e,async e=>{const t=e.config;if(e.response&&401===e.response.status&&!t._retry){t._retry=!0;const e=await S();if(e)return t.headers.Authorization="Bearer "+e,C(t);console.warn("Token refresh failed or user logged out.")}return Promise.reject(e)});var D=C,I=o("f761"),q={name:"PublisherHome",data(){return{textbooks:[],error:null}},created(){this.fetchTextbooks()},methods:{async fetchTextbooks(){try{console.log("Fetching textbooks...");const e=await D.get("/textbooks",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Textbooks fetched:",e.data),e.data&&e.data.textbooks?this.textbooks=e.data.textbooks:this.error="Failed to fetch textbooks data."}catch(e){console.error("Error fetching textbooks:",e),e.response?this.error=`Error: ${e.response.status} - ${e.response.data.message||e.response.statusText}`:this.error="Network error or server is not responding."}}}};o("7caf");const F=s()(q,[["render",B],["__scopeId","data-v-5c84c865"]]);var M=F;const A={class:"theme-publisher"},P={class:"center large-paragraph",style:{color:"#222"}},Q=["disabled"],U={key:0,class:"error-message"},L={key:1,class:"loading-message"};function $(e,t,o,c,a,l){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",A,[t[14]||(t[14]=Object(n["createElementVNode"])("div",{class:"top-banner"},[Object(n["createElementVNode"])("div",{class:"banner-title"},"Publisher Login")],-1)),Object(n["createElementVNode"])("div",P,[t[11]||(t[11]=Object(n["createTextVNode"])(" Please enter your publisher username and password: ")),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("form",{onSubmit:t[2]||(t[2]=Object(n["withModifiers"])((...e)=>l.submitForm&&l.submitForm(...e),["prevent"]))},[t[3]||(t[3]=Object(n["createElementVNode"])("label",{for:"uname"},"Username:",-1)),t[4]||(t[4]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"uname","onUpdate:modelValue":t[0]||(t[0]=e=>a.username=e)},null,512),[[n["vModelText"],a.username]]),t[5]||(t[5]=Object(n["createElementVNode"])("br",null,null,-1)),t[6]||(t[6]=Object(n["createElementVNode"])("br",null,null,-1)),t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"pass"},"Password:",-1)),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"password",id:"pass","onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e)},null,512),[[n["vModelText"],a.password]]),t[9]||(t[9]=Object(n["createElementVNode"])("br",null,null,-1)),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("input",{type:"submit",value:"Submit",disabled:a.loading},null,8,Q)],32),a.errorMessage?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",U,Object(n["toDisplayString"])(a.errorMessage),1)):Object(n["createCommentVNode"])("",!0),a.loading?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",L,"Logging in...")):Object(n["createCommentVNode"])("",!0)])])}var z={data(){return{username:"",password:"",errorMessage:"",loading:!1}},mounted(){const e=localStorage.getItem("token");if(e)try{const t=Object(I["default"])(e),o=Date.now()/1e3;t.exp>o&&"publisher"===t.role&&this.$router.push("/PubHome")}catch(t){console.error("Invalid token",t)}},methods:{async submitForm(){if(this.username&&this.password)if(this.username.trim().length<3||this.password.trim().length<6)this.errorMessage="Username must be at least 3 characters and password at least 6 characters.";else{this.loading=!0,this.errorMessage="";try{const e=await D.post("/auth/login",{username:this.username.toLowerCase(),password:this.password}),{token:t,user_id:o,role:n}=e.data;localStorage.setItem("token",t),localStorage.setItem("user_id",o),localStorage.setItem("role",n),"publisher"===n?this.$router.push("/PubHome"):(this.errorMessage="Only publishers can log in here.",localStorage.clear())}catch(e){e.response?401===e.response.status?this.errorMessage="Invalid username or password.":this.errorMessage=e.response&&e.response.data&&e.response.data.message||"An error occurred during login.":this.errorMessage="Network error. Please check your connection."}finally{this.loading=!1}}else this.errorMessage="Please enter both username and password."}}};o("17af");const H=s()(z,[["render",$],["__scopeId","data-v-800dd872"]]);var R=H;const W={class:"theme-publisher"},G={class:"top-banner"},J={class:"banner-actions"},X={class:"center large-paragraph",style:{color:"#222"}};function K(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",W,[Object(n["createElementVNode"])("div",G,[t[8]||(t[8]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Add New Textbook",-1)),Object(n["createElementVNode"])("div",J,[Object(n["createVNode"])(r,{to:"/PubHome",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[6]||(t[6]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[7]||(t[7]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",X,[Object(n["createElementVNode"])("form",{onSubmit:t[5]||(t[5]=Object(n["withModifiers"])((...e)=>l.saveBook&&l.saveBook(...e),["prevent"]))},[t[9]||(t[9]=Object(n["createElementVNode"])("label",{for:"textbookTitle"},"Textbook Title:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"textbookTitle","onUpdate:modelValue":t[0]||(t[0]=e=>a.textbookTitle=e),style:{height:"20px"}},null,512),[[n["vModelText"],a.textbookTitle]]),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),t[11]||(t[11]=Object(n["createElementVNode"])("label",{for:"author"},"Author:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"author","onUpdate:modelValue":t[1]||(t[1]=e=>a.author=e),style:{height:"20px"}},null,512),[[n["vModelText"],a.author]]),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("label",{for:"ISBN"},"ISBN:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"ISBN","onUpdate:modelValue":t[2]||(t[2]=e=>a.ISBN=e),style:{height:"20px"}},null,512),[[n["vModelText"],a.ISBN]]),t[14]||(t[14]=Object(n["createElementVNode"])("br",null,null,-1)),t[15]||(t[15]=Object(n["createElementVNode"])("label",{for:"version"},"Version:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"version","onUpdate:modelValue":t[3]||(t[3]=e=>a.version=e),style:{height:"20px"}},null,512),[[n["vModelText"],a.version]]),t[16]||(t[16]=Object(n["createElementVNode"])("br",null,null,-1)),t[17]||(t[17]=Object(n["createElementVNode"])("label",{for:"websiteLink"},"Website Link:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"websiteLink","onUpdate:modelValue":t[4]||(t[4]=e=>a.websiteLink=e),style:{height:"20px"}},null,512),[[n["vModelText"],a.websiteLink]]),t[18]||(t[18]=Object(n["createElementVNode"])("br",null,null,-1)),t[19]||(t[19]=Object(n["createElementVNode"])("div",{class:"center large-heading"},[Object(n["createElementVNode"])("input",{type:"submit",value:"Save"})],-1))],32)])])}var Y={name:"PublisherNewBook",data(){return{textbookTitle:"",author:"",ISBN:"",version:"",websiteLink:""}},methods:{async saveBook(){if(this.textbookTitle&&this.author&&this.ISBN&&this.version){const t={textbook_title:this.textbookTitle,textbook_author:this.author,textbook_isbn:this.ISBN,textbook_version:this.version,websiteLink:this.websiteLink};try{const e=await D.post("/textbooks",t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Book saved successfully:",e.data),alert("Book saved successfully!"),this.$router.push({path:"/PubQuestions"})}catch(e){console.error("Error saving book:",e),alert("Failed to save the book. Please try again.")}}else alert("Please fill out all fields.")}}};o("50c4");const Z=s()(Y,[["render",K],["__scopeId","data-v-dbb0e53c"]]);var ee=Z;const te={class:"theme-publisher"},oe={class:"top-banner"},ne={class:"banner-actions"},ce={class:"center large-paragraph",style:{color:"#222"}},ae={key:0,style:{color:"red","margin-top":"10px"}};function le(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",te,[Object(n["createElementVNode"])("div",oe,[t[6]||(t[6]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Create New Test Bank",-1)),Object(n["createElementVNode"])("div",ne,[Object(n["createVNode"])(r,{to:"/PubHome",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[4]||(t[4]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[5]||(t[5]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",ce,[Object(n["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(n["withModifiers"])((...e)=>l.saveTestBank&&l.saveTestBank(...e),["prevent"]))},[t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"bankName"},"Name of Test Bank:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankName","onUpdate:modelValue":t[0]||(t[0]=e=>a.bankName=e),style:{height:"20px"},required:""},null,512),[[n["vModelText"],a.bankName]]),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),t[9]||(t[9]=Object(n["createElementVNode"])("label",{for:"bankCh"},"Textbook Chapter:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankCh","onUpdate:modelValue":t[1]||(t[1]=e=>a.bankChapter=e)},null,512),[[n["vModelText"],a.bankChapter]]),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),t[11]||(t[11]=Object(n["createElementVNode"])("label",{for:"bankSec"},"Textbook Section:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankSec","onUpdate:modelValue":t[2]||(t[2]=e=>a.bankSection=e)},null,512),[[n["vModelText"],a.bankSection]]),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("input",{type:"submit",value:"Submit"},null,-1))],32),a.error?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ae,Object(n["toDisplayString"])(a.error),1)):Object(n["createCommentVNode"])("",!0)])])}var re={name:"PublisherNewTB",data(){return{bankName:"",bankChapter:"",bankSection:"",textbookId:this.$route.query.textbook_id||"",textbookTitle:this.$route.query.title||"",error:null}},methods:{async saveTestBank(){if(this.bankName&&this.bankChapter&&this.bankSection&&this.textbookId){const t={testbank_name:this.bankName,chapter_number:this.bankChapter,section_number:this.bankSection,textbook_id:this.textbookId};try{const e=await D.post("/testbanks/publisher",t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Test bank saved successfully:",e.data),alert("Test bank saved successfully!"),this.$router.push({path:"PubQuestions",query:{title:this.textbookTitle,textbook_id:this.textbookId}})}catch(e){console.error("Error saving test bank:",e),alert("Failed to save the test bank. Please try again.")}}else alert("Please fill out all fields.")}}};o("39c0");const se=s()(re,[["render",le],["__scopeId","data-v-7791f769"]]);var ie=se;const de={class:"theme-publisher"},ue={class:"top-banner"},be={class:"banner-title"},me={class:"banner-actions"},pe={class:"page-wrapper"},he={class:"button-row"},Oe={class:"p_dropdown"},je={class:"p_dropbtn"},Ne={class:"p_dropdown-content"},ke=["onClick"],ge={class:"p_dropdown"},Ee={class:"p_dropdown-content"},Ve={id:"selectedQuestionType",style:{color:"#222"},class:"center large-paragraph"},ye=["onClick"],we={key:0},fe={key:1},Te={key:2},ve={key:3},_e={key:4},Be={key:5},xe={key:6,class:"p_button-group"},Ce=["onClick"],Se=["onClick"],De=["onClick"],Ie={class:"form-popup-modal"},qe={class:"form-container",style:{display:"flex","flex-direction":"column","align-items":"center",gap:"10px","margin-top":"1rem"}},Fe=["onClick"],Me={class:"form-popup-modal"},Ae={key:0},Pe={key:1},Qe={key:2},Ue=["onUpdate:modelValue"],Le=["onUpdate:modelValue"],$e=["onClick"],ze={key:3},He={key:4},Re={key:5},We=["src"];function Ge(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",de,[Object(n["createElementVNode"])("div",ue,[Object(n["createElementVNode"])("div",be,Object(n["toDisplayString"])(a.textbookTitle),1),Object(n["createElementVNode"])("div",me,[Object(n["createVNode"])(r,{to:"/PubHome",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[26]||(t[26]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[27]||(t[27]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",pe,[Object(n["createElementVNode"])("div",he,[Object(n["createElementVNode"])("div",Oe,[Object(n["createElementVNode"])("button",je,Object(n["toDisplayString"])(a.selectedTestBank?a.selectedTestBank.name:"Select Draft Pool"),1),Object(n["createElementVNode"])("div",Ne,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.testBanks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:e.testbank_id,href:"#",onClick:Object(n["withModifiers"])(t=>l.selectTestBank(e),["prevent"])},Object(n["toDisplayString"])(e.name),9,ke))),128))])]),Object(n["createVNode"])(r,{to:{path:"PubNewTB",query:{title:a.textbookTitle,textbook_id:a.textbookId}}},{default:Object(n["withCtx"])(()=>t[28]||(t[28]=[Object(n["createElementVNode"])("button",{class:"p_button"},"New Draft Pool",-1)])),_:1},8,["to"]),Object(n["createElementVNode"])("div",ge,[t[29]||(t[29]=Object(n["createElementVNode"])("button",{class:"p_dropbtn"},"Question Type",-1)),Object(n["createElementVNode"])("div",Ee,[Object(n["createElementVNode"])("a",{href:"#",onClick:t[0]||(t[0]=e=>l.fetchQuestions("True/False"))},"True/False"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[1]||(t[1]=e=>l.fetchQuestions("Multiple Choice"))},"Multiple Choice"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[2]||(t[2]=e=>l.fetchQuestions("Matching"))},"Matching"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[3]||(t[3]=e=>l.fetchQuestions("Fill in the Blank"))},"Fill in the Blank"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[4]||(t[4]=e=>l.fetchQuestions("Short Answer"))},"Short Answer"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[5]||(t[5]=e=>l.fetchQuestions("Essay"))},"Essay")])]),Object(n["createElementVNode"])("button",{class:"p_button",onClick:t[6]||(t[6]=(...e)=>l.edit&&l.edit(...e))},"New Question")]),Object(n["createElementVNode"])("div",Ve,Object(n["toDisplayString"])(a.selectedQuestionType),1),t[75]||(t[75]=Object(n["createElementVNode"])("hr",null,null,-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.questions,(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:o,class:Object(n["normalizeClass"])(["p_question-box",{selected:a.selectedQuestionId===e.id}]),onClick:t=>l.toggleQuestionSelection(e.id)},[Object(n["createElementVNode"])("strong",null,"Question "+Object(n["toDisplayString"])(o+1)+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.text),1),t[44]||(t[44]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[30]||(t[30]=Object(n["createElementVNode"])("strong",null,"Type:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.type),1)]),t[45]||(t[45]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[31]||(t[31]=Object(n["createElementVNode"])("strong",null,"Chapter:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.chapter||"N/A"),1)]),t[46]||(t[46]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[32]||(t[32]=Object(n["createElementVNode"])("strong",null,"Section:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.section||"N/A"),1)]),t[47]||(t[47]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[33]||(t[33]=Object(n["createElementVNode"])("strong",null,"Points:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.points),1)]),t[48]||(t[48]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[34]||(t[34]=Object(n["createElementVNode"])("strong",null,"Estimated Time:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.time)+" minutes",1)]),t[49]||(t[49]=Object(n["createElementVNode"])("br",null,null,-1)),"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",we,[t[35]||(t[35]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer?"True":"False"),1)])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",fe,[t[36]||(t[36]=Object(n["createElementVNode"])("strong",null,"Correct Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.correctOption&&e.correctOption.option_text||"Not specified"),1),t[37]||(t[37]=Object(n["createElementVNode"])("br",null,null,-1)),t[38]||(t[38]=Object(n["createElementVNode"])("strong",null,"Other Options:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.incorrectOptions,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.option_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Te,[t[39]||(t[39]=Object(n["createElementVNode"])("strong",null,"Pairs:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.pairs,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.term)+" - "+Object(n["toDisplayString"])(e.definition),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ve,[t[40]||(t[40]=Object(n["createElementVNode"])("strong",null,"Correct Answer(s):",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.blanks,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.correct_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Short Answer"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",_e,[t[41]||(t[41]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer||"Not provided"),1)])):Object(n["createCommentVNode"])("",!0),"Essay"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Be,[t[42]||(t[42]=Object(n["createElementVNode"])("strong",null,"Essay Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.instructions||"None"),1)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("span",null,[t[43]||(t[43]=Object(n["createElementVNode"])("strong",null,"Grading Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.instructions||"None"),1)]),a.selectedQuestionId===e.id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",xe,[Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>l.editQuestion(e),["stop"])},"Edit",8,Ce),Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>l.deleteQuestion(e.id),["stop"])},"Delete",8,Se),Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>l.openAddToTestBank(e.id),["stop"])},"Add to Test Bank",8,De)])):Object(n["createCommentVNode"])("",!0)],10,ye))),128))]),a.showAddToTBModal?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"popup-overlay",onClick:t[8]||(t[8]=Object(n["withModifiers"])((...e)=>l.closeAddToTBModal&&l.closeAddToTBModal(...e),["self"]))},[Object(n["createElementVNode"])("div",Ie,[t[50]||(t[50]=Object(n["createElementVNode"])("p",{style:{color:"red","font-weight":"bold","text-align":"center","margin-bottom":"1rem"}}," Once the question is added to a draft pool, it can no longer be edited. ",-1)),t[51]||(t[51]=Object(n["createElementVNode"])("h2",{style:{"text-align":"center"}},"Select Draft Pool",-1)),Object(n["createElementVNode"])("div",qe,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.testBanks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("button",{key:e.testbank_id,class:"t_button",style:{width:"100%"},onClick:t=>l.assignQuestionToTestBank(e.testbank_id)},Object(n["toDisplayString"])(e.name),9,Fe))),128)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",style:{width:"100%"},onClick:t[7]||(t[7]=(...e)=>l.closeAddToTBModal&&l.closeAddToTBModal(...e))}," Close ")])])])):Object(n["createCommentVNode"])("",!0),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"popup-overlay",onClick:t[25]||(t[25]=Object(n["withModifiers"])((...e)=>l.closeForm&&l.closeForm(...e),["self"]))},[Object(n["createElementVNode"])("div",Me,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[24]||(t[24]=Object(n["withModifiers"])((...e)=>l.handleQuestionSave&&l.handleQuestionSave(...e),["prevent"]))},[t[60]||(t[60]=Object(n["createElementVNode"])("h1",null,"New Question",-1)),t[61]||(t[61]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Chapter Number")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=e=>a.questionData.chapter=e),required:""},null,512),[[n["vModelText"],a.questionData.chapter]]),t[62]||(t[62]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Section Number")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=e=>a.questionData.section=e),required:""},null,512),[[n["vModelText"],a.questionData.section]]),t[63]||(t[63]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Question Type"),Object(n["createElementVNode"])("br")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{"onUpdate:modelValue":t[11]||(t[11]=e=>a.selectedQuestionType=e),required:""},t[52]||(t[52]=[Object(n["createElementVNode"])("option",{disabled:"",value:""},"Select a type",-1),Object(n["createElementVNode"])("option",null,"True/False",-1),Object(n["createElementVNode"])("option",null,"Multiple Choice",-1),Object(n["createElementVNode"])("option",null,"Matching",-1),Object(n["createElementVNode"])("option",null,"Fill in the Blank",-1),Object(n["createElementVNode"])("option",null,"Short Answer",-1),Object(n["createElementVNode"])("option",null,"Essay",-1)]),512),[[n["vModelSelect"],a.selectedQuestionType]]),t[64]||(t[64]=Object(n["createElementVNode"])("br",null,null,-1)),t[65]||(t[65]=Object(n["createElementVNode"])("br",null,null,-1)),t[66]||(t[66]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Question Text")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[12]||(t[12]=e=>a.questionData.question=e),required:""},null,512),[[n["vModelText"],a.questionData.question]]),"True/False"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ae,[t[54]||(t[54]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{"onUpdate:modelValue":t[13]||(t[13]=e=>a.questionData.answer=e)},t[53]||(t[53]=[Object(n["createElementVNode"])("option",{value:"True"},"True",-1),Object(n["createElementVNode"])("option",{value:"False"},"False",-1)]),512),[[n["vModelSelect"],a.questionData.answer]])])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Pe,[t[55]||(t[55]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Correct Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[14]||(t[14]=e=>a.questionData.answer=e)},null,512),[[n["vModelText"],a.questionData.answer]]),t[56]||(t[56]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Incorrect Answer Choices (comma-separated)")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=e=>a.questionData.answerChoices=e)},null,512),[[n["vModelText"],a.questionData.answerChoices]])])):Object(n["createCommentVNode"])("",!0),"Matching"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Qe,[t[57]||(t[57]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Matching Pairs")],-1)),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.matchingPairs,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:t},[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t=>e.term=t,placeholder:"Term"},null,8,Ue),[[n["vModelText"],e.term]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t=>e.definition=t,placeholder:"Definition"},null,8,Le),[[n["vModelText"],e.definition]]),Object(n["createElementVNode"])("button",{type:"button",onClick:e=>l.removePair(t)},"Remove",8,$e)]))),128)),Object(n["createElementVNode"])("button",{type:"button",onClick:t[16]||(t[16]=(...e)=>l.addPair&&l.addPair(...e))},"Add Pair")])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ze,[t[58]||(t[58]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Correct Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=e=>a.questionData.answer=e)},null,512),[[n["vModelText"],a.questionData.answer]])])):Object(n["createCommentVNode"])("",!0),"Short Answer"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",He,[t[59]||(t[59]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[18]||(t[18]=e=>a.questionData.answer=e)},null,512),[[n["vModelText"],a.questionData.answer]])])):Object(n["createCommentVNode"])("",!0),"Essay"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Re)):Object(n["createCommentVNode"])("",!0),t[67]||(t[67]=Object(n["createElementVNode"])("br",null,null,-1)),t[68]||(t[68]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Points Worth")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[19]||(t[19]=e=>a.questionData.points=e),required:""},null,512),[[n["vModelText"],a.questionData.points]]),t[69]||(t[69]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Estimated Time (in minutes)")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[20]||(t[20]=e=>a.questionData.time=e),required:""},null,512),[[n["vModelText"],a.questionData.time]]),t[70]||(t[70]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Grading Instructions")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[21]||(t[21]=e=>a.questionData.instructions=e),required:""},null,512),[[n["vModelText"],a.questionData.instructions]]),t[71]||(t[71]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Upload Image")],-1)),Object(n["createElementVNode"])("input",{type:"file",onChange:t[22]||(t[22]=(...e)=>l.handleImageUpload&&l.handleImageUpload(...e)),accept:"image/*"},null,32),a.imagePreview?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:6,src:a.imagePreview,alt:"Preview",style:{"max-width":"100%"}},null,8,We)):Object(n["createCommentVNode"])("",!0),t[72]||(t[72]=Object(n["createElementVNode"])("br",null,null,-1)),t[73]||(t[73]=Object(n["createElementVNode"])("br",null,null,-1)),t[74]||(t[74]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Save",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[23]||(t[23]=(...e)=>l.closeForm&&l.closeForm(...e))},"Close")],32)])],512),[[n["vShow"],a.showForm]])])])}var Je={name:"PubQuestions",data(){return{textbookTitle:"",textbookId:"",testBanks:[],selectedTestBank:null,selectedQuestionType:"",questions:[],selectedQuestionId:null,showForm:!1,showAddToTBModal:!1,questionToAddToTB:null,matchingPairs:[],imagePreview:"",questionData:{chapter:"",section:"",question:"",reference:"",answer:"",answerChoices:"",points:"",time:"",instructions:"",imageFile:null,editingQuestionId:null,oldMCOptionIds:[]}}},methods:{async handleQuestionSave(){try{let e,t;const o=!!this.editingQuestionId,n=this.questions.find(e=>e.id===this.editingQuestionId);if(this.questionData.imageFile){if(e=new FormData,e.append("file",this.questionData.imageFile),e.append("question_text",this.questionData.question),e.append("default_points",this.questionData.points),e.append("est_time",this.questionData.time),e.append("chapter_number",this.questionData.chapter),e.append("section_number",this.questionData.section),e.append("grading_instructions",this.questionData.instructions),e.append("type",this.selectedQuestionType),e.append("source","manual"),e.append("textbook_id",this.textbookId),"True/False"===this.selectedQuestionType)e.append("true_false_answer","True"===this.questionData.answer);else if("Multiple Choice"===this.selectedQuestionType){const t=this.questionData.answerChoices.split(",").map(e=>e.trim()).filter(Boolean),o=[{option_text:this.questionData.answer.trim(),is_correct:!0},...t.map(e=>({option_text:e,is_correct:!1}))];e.append("options",JSON.stringify(o))}else"Matching"===this.selectedQuestionType?e.append("matches",JSON.stringify(this.matchingPairs.map(e=>({prompt_text:e.term,match_text:e.definition})))):"Fill in the Blank"===this.selectedQuestionType?e.append("blanks",JSON.stringify([{correct_text:this.questionData.answer}])):"Short Answer"===this.selectedQuestionType?e.append("answer",this.questionData.answer):"Essay"===this.selectedQuestionType&&e.append("grading_instructions",this.questionData.instructions);for(let[t,o]of e.entries())console.log(t+":",o);t={headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"multipart/form-data"}}}else{if(e={question_text:this.questionData.question,default_points:parseInt(this.questionData.points),est_time:parseInt(this.questionData.time),chapter_number:this.questionData.chapter,section_number:this.questionData.section,grading_instructions:this.questionData.instructions,type:this.selectedQuestionType,source:"manual",textbook_id:this.textbookId},"True/False"===this.selectedQuestionType)e.true_false_answer="True"===this.questionData.answer;else if("Multiple Choice"===this.selectedQuestionType){const t=this.questionData.answerChoices.split(",").map(e=>e.trim()).filter(Boolean);e.options=[{option_text:this.questionData.answer.trim(),is_correct:!0},...t.map(e=>({option_text:e,is_correct:!1}))],o&&this.oldMCOptionIds.length>0&&(e.to_delete=this.oldMCOptionIds)}else if("Matching"===this.selectedQuestionType){if(e.matches=this.matchingPairs.map(e=>({prompt_text:e.term,match_text:e.definition})),o&&n){const t=(n.pairs||[]).map(e=>e.match_id);e.to_delete=t}}else"Fill in the Blank"===this.selectedQuestionType?e.blanks=[{correct_text:this.questionData.answer}]:"Short Answer"===this.selectedQuestionType?e.answer=this.questionData.answer:"Essay"===this.selectedQuestionType&&(e.grading_instructions=this.questionData.instructions);t={headers:{Authorization:"Bearer "+localStorage.getItem("token")}}}o?await D.patch("/questions/"+this.editingQuestionId,e,t):await D.post("/questions",e,t),alert("Question saved successfully!"),this.closeForm(),this.resetForm(),this.fetchQuestions(this.selectedQuestionType)}catch(e){let t="Something went wrong.";e&&e.response&&e.response.data&&(t=e.response.data.error||e.response.data.message||t),alert("Save failed: "+t),console.error("Error saving question:",e)}},async fetchTestBanks(){try{const e=await D.get("/testbanks/publisher",{params:{textbook_id:this.textbookId},headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.testBanks=e.data.testbanks}catch(e){console.error("Error loading test banks:",e)}},async fetchQuestions(e){this.selectedQuestionType=e;try{const t=await D.get("/questions",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{textbook_id:this.textbookId,type:e}});Array.isArray(t.data.questions)?this.questions=t.data.questions.map(e=>{const t={text:e.question_text,type:e.type,points:e.default_points,id:e.id,instructions:e.grading_instructions||"",time:e.est_time,chapter:e.chapter_number,section:e.section_number};switch(e.type){case"True/False":return{...t,answer:e.true_false_answer};case"Multiple Choice":return{...t,correctOption:e.correct_option||null,incorrectOptions:e.incorrect_options||[]};case"Matching":return{...t,pairs:(e.matches||[]).map(e=>({term:e.prompt_text,definition:e.match_text}))};case"Fill in the Blank":return{...t,blanks:e.blanks||[]};case"Short Answer":return{...t,answer:e.answer||""};case"Essay":return t;default:return t}}):this.questions=[]}catch(t){console.error("Error fetching questions:",t),this.questions=[]}},openAddToTestBank(e){this.questionToAddToTB=e,this.showAddToTBModal=!0},closeAddToTBModal(){this.questionToAddToTB=null,this.showAddToTBModal=!1},async assignQuestionToTestBank(e){if(this.questionToAddToTB)try{await D.post(`/testbanks/publisher/${e}/questions`,{question_ids:[this.questionToAddToTB]},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),alert("Question successfully added to testbank!"),this.closeAddToTBModal()}catch(t){console.error("Failed to add question to testbank:",t),alert("Failed to add question.")}},selectTestBank(e){this.$router.push({name:"PubViewTB",query:{testbank_id:e.testbank_id,name:e.name,textbook_id:this.textbookId,title:this.textbookTitle,chapter:e.chapter_number,section:e.section_number}})},toggleQuestionSelection(e){this.selectedQuestionId=this.selectedQuestionId===e?null:e},selectQuestionType(e){this.selectedQuestionType=e,this.edit()},edit(){this.showForm=!0},closeForm(){this.showForm=!1,this.resetForm()},addPair(){this.matchingPairs.push({term:"",definition:""})},removePair(e){this.matchingPairs.splice(e,1)},handleImageUpload(e){const t=e.target.files[0];if(t){this.questionData.imageFile=t;const e=new FileReader;e.onload=e=>{this.imagePreview=e.target.result},e.readAsDataURL(t)}},resetForm(){this.questionData={chapter:"",section:"",question:"",reference:"",answer:"",answerChoices:"",points:"",time:"",instructions:"",imageFile:null},this.selectedQuestionType="",this.matchingPairs=[],this.imagePreview="",this.editingQuestionId=null,this.oldMCOptionIds=[]},editQuestion(e){this.editingQuestionId=e.id,this.questionData.question=e.text,this.questionData.chapter=e.chapter,this.questionData.section=e.section,this.questionData.points=e.points,this.questionData.time=e.time,this.questionData.instructions=e.instructions,this.questionData.answer=e.answer||"",this.selectedQuestionType=e.type,"Multiple Choice"===e.type?(this.questionData.answer=e.correctOption&&e.correctOption.option_text||"",this.questionData.answerChoices=e.incorrectOptions.map(e=>e.option_text).join(", "),this.oldMCOptionIds=[],e.correctOption&&e.correctOption.option_id&&this.oldMCOptionIds.push(e.correctOption.option_id),Array.isArray(e.incorrectOptions)&&e.incorrectOptions.forEach(e=>{e.option_id&&this.oldMCOptionIds.push(e.option_id)})):"Matching"===e.type&&(this.matchingPairs=e.pairs.map(e=>({term:e.term,definition:e.definition}))),this.showForm=!0},async deleteQuestion(e){if(confirm("Are you sure you want to delete this question?"))try{await D.delete("/questions/"+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.questions=this.questions.filter(t=>t.id!==e),alert("Question deleted.")}catch(t){console.error(t),alert("Failed to delete question.")}}},mounted(){this.textbookTitle=this.$route.query.title||"Book Title",this.textbookId=this.$route.query.textbook_id||"",this.textbookId&&this.fetchTestBanks()}};o("2cdb");const Xe=s()(Je,[["render",Ge],["__scopeId","data-v-521f0f15"]]);var Ke=Xe;const Ye={class:"theme-publisher"},Ze={class:"top-banner"},et={class:"banner-title"},tt={class:"banner-actions"},ot={class:"center large-paragraph",style:{color:"#222"}},nt={id:"feedbackContainer"},ct={key:0},at={key:1};function lt(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ye,[Object(n["createElementVNode"])("div",Ze,[Object(n["createElementVNode"])("div",et,"Draft Pool: "+Object(n["toDisplayString"])(a.selectedTestBank),1),Object(n["createElementVNode"])("div",tt,[Object(n["createVNode"])(r,{to:"/PubHome",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[0]||(t[0]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[1]||(t[1]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",ot,[Object(n["createVNode"])(r,{to:"PubViewTB"},{default:Object(n["withCtx"])(()=>t[2]||(t[2]=[Object(n["createElementVNode"])("button",{class:"p_button"},"Return to Test Banks",-1)])),_:1}),t[3]||(t[3]=Object(n["createElementVNode"])("hr",null,null,-1)),Object(n["createElementVNode"])("div",nt,[0===a.feedbackList.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",ct,"No feedback available.")):(Object(n["openBlock"])(),Object(n["createElementBlock"])("ul",at,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.feedbackList,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},[Object(n["createElementVNode"])("strong",null,Object(n["toDisplayString"])(e.testBank)+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.comment),1)]))),128))]))])])])}var rt={name:"PubViewFeedback",data(){return{feedbackList:[],testbankId:null,selectedTestBank:this.$route.query.name||"No Test Bank Selected"}},mounted(){this.testbankId=this.$route.params.testbank_id,console.log("Viewing feedback for Test Bank ID:",this.testbankId),fetch("/api/feedback?testbank_id="+this.testbankId).then(e=>e.json()).then(e=>{this.feedbackList=e}),fetch("/api/testbank/"+this.testbankId).then(e=>e.json()).then(e=>{this.selectedTestBank=e.name})}};o("2ac8");const st=s()(rt,[["render",lt],["__scopeId","data-v-062ad94e"]]);var it=st;const dt={class:"theme-publisher"},ut={class:"top-banner"},bt={class:"banner-title"},mt={class:"banner-actions"},pt={class:"page-wrapper"},ht={class:"button-row"},Ot=["disabled"],jt=["disabled"],Nt={key:0,class:"popup-overlay"},kt={class:"form-popup-modal"},gt={key:1,class:"publish-warning"},Et={id:"questionsContainer"},Vt=["onClick"],yt={key:0},wt={key:1},ft={key:2},Tt={key:3},vt={key:4},_t={key:5},Bt={key:6,class:"p_button-group"},xt=["onClick","disabled"];function Ct(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",dt,[Object(n["createElementVNode"])("div",ut,[Object(n["createElementVNode"])("div",bt,"Draft Pool: "+Object(n["toDisplayString"])(a.selectedTestBank),1),Object(n["createElementVNode"])("div",mt,[Object(n["createVNode"])(r,{to:"/PubHome",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[9]||(t[9]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"banner-btn"},{default:Object(n["withCtx"])(()=>t[10]||(t[10]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",pt,[Object(n["createElementVNode"])("div",ht,[Object(n["createElementVNode"])("button",{class:"p_button",onClick:t[0]||(t[0]=e=>a.showEditForm=!0)},"Edit Draft Pool Info"),Object(n["createVNode"])(r,{to:{path:"/PubQuestions",query:{title:this.textbookTitle,textbook_id:this.textbookId}}},{default:Object(n["withCtx"])(()=>t[11]||(t[11]=[Object(n["createElementVNode"])("button",{class:"p_button"},"Return to Question Page",-1)])),_:1},8,["to"]),Object(n["createVNode"])(r,{to:{name:"PubViewFeedback",params:{testbank_id:a.selectedTestBankId},query:{name:a.selectedTestBank}}},{default:Object(n["withCtx"])(()=>t[12]||(t[12]=[Object(n["createElementVNode"])("button",{class:"p_button"},"View Feedback",-1)])),_:1},8,["to"]),Object(n["createElementVNode"])("button",{class:"p_button",onClick:t[1]||(t[1]=(...e)=>l.publishTestbank&&l.publishTestbank(...e)),disabled:a.published},Object(n["toDisplayString"])(a.published?"Draft Pool Published":"Publish Draft Pool"),9,Ot),Object(n["createElementVNode"])("button",{class:"p_button delete",onClick:t[2]||(t[2]=(...e)=>l.deleteTestBank&&l.deleteTestBank(...e)),disabled:a.published}," Delete Draft Pool ",8,jt)]),a.showEditForm?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Nt,[Object(n["createElementVNode"])("div",kt,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[7]||(t[7]=Object(n["withModifiers"])((...e)=>l.updateTestBank&&l.updateTestBank(...e),["prevent"]))},[t[13]||(t[13]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Draft Pool Name:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>a.editForm.name=e),required:""},null,512),[[n["vModelText"],a.editForm.name]]),t[14]||(t[14]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Chapter Number:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>a.editForm.chapter=e),required:""},null,512),[[n["vModelText"],a.editForm.chapter]]),t[15]||(t[15]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Section Number:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>a.editForm.section=e),required:""},null,512),[[n["vModelText"],a.editForm.section]]),t[16]||(t[16]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Save Changes",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[6]||(t[6]=e=>a.showEditForm=!1)},"Cancel")],32)])])):Object(n["createCommentVNode"])("",!0),a.published?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",gt,t[17]||(t[17]=[Object(n["createElementVNode"])("strong",null,"Note:",-1),Object(n["createTextVNode"])(" This draft pool has been published. Question details can no longer be edited or removed. The draft pool cannot be deleted or modified. ")]))):Object(n["createCommentVNode"])("",!0),t[39]||(t[39]=Object(n["createElementVNode"])("hr",null,null,-1)),t[40]||(t[40]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("div",Et,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.selectedQuestions,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",{key:e},Object(n["toDisplayString"])(e),1))),128))]),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.questions,(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:o,class:Object(n["normalizeClass"])(["p_question-box",{selected:a.selectedQuestionId===e.id}]),onClick:t=>l.toggleQuestionSelection(e.id)},[Object(n["createElementVNode"])("strong",null,"Question "+Object(n["toDisplayString"])(o+1)+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.text),1),t[32]||(t[32]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[18]||(t[18]=Object(n["createElementVNode"])("strong",null,"Type:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.type),1)]),t[33]||(t[33]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[19]||(t[19]=Object(n["createElementVNode"])("strong",null,"Chapter:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.chapter||"N/A"),1)]),t[34]||(t[34]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[20]||(t[20]=Object(n["createElementVNode"])("strong",null,"Section:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.section||"N/A"),1)]),t[35]||(t[35]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[21]||(t[21]=Object(n["createElementVNode"])("strong",null,"Points:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.points),1)]),t[36]||(t[36]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[22]||(t[22]=Object(n["createElementVNode"])("strong",null,"Estimated Time:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.time)+" minutes",1)]),t[37]||(t[37]=Object(n["createElementVNode"])("br",null,null,-1)),"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",yt,[t[23]||(t[23]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer?"True":"False"),1)])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",wt,[t[24]||(t[24]=Object(n["createElementVNode"])("strong",null,"Correct Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.correctOption&&e.correctOption.option_text||"Not specified"),1),t[25]||(t[25]=Object(n["createElementVNode"])("br",null,null,-1)),t[26]||(t[26]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Other Options:")],-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.incorrectOptions,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t,class:"incorrect-answer"},Object(n["toDisplayString"])(e.option_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Short Answer"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ft,[t[27]||(t[27]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer||"Not provided"),1)])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Tt,[t[28]||(t[28]=Object(n["createElementVNode"])("strong",null,"Correct Answer(s):",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.blanks,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.correct_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",vt,[t[29]||(t[29]=Object(n["createElementVNode"])("strong",null,"Pairs:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.pairs,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.term)+" - "+Object(n["toDisplayString"])(e.definition),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Essay"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",_t,[t[30]||(t[30]=Object(n["createElementVNode"])("strong",null,"Essay Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.instructions||"None"),1)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("span",null,[t[31]||(t[31]=Object(n["createElementVNode"])("strong",null,"Grading Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.instructions||"None"),1)]),t[38]||(t[38]=Object(n["createElementVNode"])("br",null,null,-1)),a.selectedQuestionId===e.id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Bt,[Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>l.removeQuestionFromTestBank(e.id),["stop"]),disabled:a.published},Object(n["toDisplayString"])(a.published?"Published - Cannot Remove":"Remove from Draft Pool"),9,xt)])):Object(n["createCommentVNode"])("",!0)],10,Vt))),128))]),Object(n["createElementVNode"])("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:t[8]||(t[8]=(...t)=>e.handleFileUpload&&e.handleFileUpload(...t))},null,32)])])}var St={name:"PublisherViewTB",data(){return{showPopup:!1,showEditForm:!1,selectedTestBank:this.$route.query.name||"No Test Bank Selected",selectedTestBankId:this.$route.query.testbank_id||this.$route.params.testbank_id||null,textbookId:this.$route.query.textbook_id||null,textbookTitle:this.$route.query.title||null,selectedQuestionId:null,published:!1,questions:[],editForm:{name:this.$route.query.name||"",chapter:this.$route.query.chapter||"",section:this.$route.query.section||""}}},computed:{selectedQuestions(){return this.questions[this.selectedTestBank]||[]}},mounted(){this.loadQuestions()},methods:{selectTestBank(e){this.selectedTestBank=e},edit(){this.showPopup=!0},closeForm(){this.showPopup=!1,this.showEditForm=!1},async updateTestBank(){try{await D.put("/testbanks/publisher/"+this.selectedTestBankId,{name:this.editForm.name,chapter_number:this.editForm.chapter,section_number:this.editForm.section},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.selectedTestBank=this.editForm.name,this.showEditForm=!1,alert("Test bank updated successfully.")}catch(e){console.error("Error updating test bank:",e),alert("Failed to update test bank.")}},async loadQuestions(){if(this.selectedTestBankId)try{const e=await D.get(`/testbanks/publisher/${this.selectedTestBankId}/questions`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),t=e.data.questions||[];this.published=e.data.is_published||!1,this.questions=t.map(e=>{const t={id:e.id,text:e.question_text,type:e.type,chapter:e.chapter_number||"N/A",section:e.section_number||"N/A",points:e.default_points||"N/A",time:e.est_time||"N/A",instructions:e.grading_instructions||"None"};switch(e.type){case"True/False":return{...t,answer:e.true_false_answer};case"Multiple Choice":return{...t,correctOption:e.correct_option||null,incorrectOptions:e.incorrect_options||[]};case"Matching":return{...t,pairs:(e.matches||[]).map(e=>({term:e.prompt_text,definition:e.match_text}))};case"Fill in the Blank":return{...t,blanks:e.blanks||[]};case"Short Answer":return{...t,answer:e.answer||""};case"Essay":return t;default:return t}})}catch(e){console.error("Error loading test bank questions:",e)}},toggleQuestionSelection(e){this.selectedQuestionId===e?this.selectedQuestionId=null:this.selectedQuestionId=e},async removeQuestionFromTestBank(e){if(this.published)alert("This test bank is published and cannot be modified.");else if(this.selectedTestBankId){if(confirm("Are you sure you want to remove this question from the test bank?"))try{await D.delete(`/testbanks/${this.selectedTestBankId}/questions/${e}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.questions=this.questions.filter(t=>t.id!==e),this.selectedQuestionId=null,alert("Question removed from test bank.")}catch(t){console.error("Error removing question:",t),alert("Failed to remove question from test bank.")}}else alert("Test bank ID is missing. Cannot remove question.")},async publishTestbank(){if(this.selectedTestBankId)try{await D.post(`/testbanks/${this.selectedTestBankId}/publish`,{},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.published=!0,alert("Test bank published successfully. Questions are now locked.")}catch(e){console.error("Error publishing test bank:",e),alert("Failed to publish test bank.")}},async deleteTestBank(){if(this.published)alert("Cannot delete a published test bank.");else if(confirm("Are you sure you want to delete this entire draft pool? This action cannot be undone."))try{await D.delete("/testbanks/"+this.selectedTestBankId,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),alert("Draft pool deleted successfully."),this.$router.push({path:"/PubQuestions",query:{title:this.textbookTitle,textbook_id:this.textbookId}})}catch(e){console.error("Error deleting draft pool:",e),alert("Failed to delete draft pool.")}}}};o("3f22");const Dt=s()(St,[["render",Ct],["__scopeId","data-v-90f7c052"]]);var It=Dt;const qt={class:"theme-teacher"},Ft={class:"top-banner"},Mt={class:"t_banner-actions"},At={class:"center large-paragraph",style:{color:"#222"}},Pt={class:"page-wrapper"},Qt={class:"button-row"},Ut={key:0,class:"t_dropdown"},Lt={class:"t_dropdown-content"},$t=["onClick"],zt={key:1};function Ht(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",qt,[Object(n["createElementVNode"])("div",Ft,[t[1]||(t[1]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Course Selection",-1)),Object(n["createElementVNode"])("div",Mt,[Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[0]||(t[0]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",At,[Object(n["createElementVNode"])("div",Pt,[t[4]||(t[4]=Object(n["createTextVNode"])(" Please select or create a course: ")),Object(n["createElementVNode"])("div",Qt,[a.courses.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ut,[t[2]||(t[2]=Object(n["createElementVNode"])("button",{class:"t_dropbtn"},"Select Course",-1)),Object(n["createElementVNode"])("div",Lt,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.courses,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:e.id,onClick:t=>l.selectCourse(e)},Object(n["toDisplayString"])(e.title),9,$t))),128))])])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",zt," No courses available. ")),Object(n["createVNode"])(r,{to:"TeacherNewClass"},{default:Object(n["withCtx"])(()=>t[3]||(t[3]=[Object(n["createElementVNode"])("button",{class:"t_button"},"Create New Course",-1)])),_:1})])])]),t[5]||(t[5]=Object(n["createElementVNode"])("br",null,null,-1))])}var Rt={name:"TeacherHome",data(){return{courses:[],error:null}},created(){this.fetchCourses()},methods:{async fetchCourses(){try{console.log("Fetching courses...");const e=await D.get("/courses",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Courses fetched:",e.data),Array.isArray(e.data)?this.courses=e.data.map(e=>({id:e.course_id,title:e.course_name})):this.error="Failed to fetch course data."}catch(e){console.error("Error fetching course:",e),e.response?this.error=e.response.data.error||e.response.statusText:this.error="Network error or server is not responding."}},selectCourse(e){this.$router.push({name:"TeacherQuestions",query:{courseId:e.id,courseTitle:e.title}})}}};o("d3cc");const Wt=s()(Rt,[["render",Ht],["__scopeId","data-v-2229d448"]]);var Gt=Wt;const Jt={class:"theme-teacher"},Xt={class:"center large-paragraph",style:{color:"#222"}},Kt=["disabled"],Yt={key:0,class:"error-message"},Zt={key:1,class:"loading-message"};function eo(e,t,o,c,a,l){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Jt,[t[14]||(t[14]=Object(n["createElementVNode"])("div",{class:"top-banner"},[Object(n["createElementVNode"])("div",{class:"banner-title"},"Teacher Login")],-1)),Object(n["createElementVNode"])("div",Xt,[t[11]||(t[11]=Object(n["createTextVNode"])(" Please enter your teacher username and password: ")),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("form",{onSubmit:t[2]||(t[2]=Object(n["withModifiers"])((...e)=>l.submitForm&&l.submitForm(...e),["prevent"]))},[t[3]||(t[3]=Object(n["createElementVNode"])("label",{for:"uname"},"Username:",-1)),t[4]||(t[4]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"uname","onUpdate:modelValue":t[0]||(t[0]=e=>a.username=e)},null,512),[[n["vModelText"],a.username]]),t[5]||(t[5]=Object(n["createElementVNode"])("br",null,null,-1)),t[6]||(t[6]=Object(n["createElementVNode"])("br",null,null,-1)),t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"pass"},"Password:",-1)),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"password",id:"pass","onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e)},null,512),[[n["vModelText"],a.password]]),t[9]||(t[9]=Object(n["createElementVNode"])("br",null,null,-1)),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("input",{type:"submit",value:"Submit",disabled:a.loading},null,8,Kt)],32),a.errorMessage?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Yt,Object(n["toDisplayString"])(a.errorMessage),1)):Object(n["createCommentVNode"])("",!0),a.loading?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Zt,"Logging in...")):Object(n["createCommentVNode"])("",!0)])])}var to={data(){return{username:"",password:"",errorMessage:"",loading:!1}},mounted(){const e=localStorage.getItem("token");if(e)try{const t=Object(I["default"])(e),o=Date.now()/1e3;t.exp>o&&"teacher"===t.role&&this.$router.push("/TeacherHome")}catch(t){console.error("Invalid token",t)}},methods:{async submitForm(){if(this.username&&this.password)if(this.username.trim().length<3||this.password.trim().length<6)this.errorMessage="Username must be at least 3 characters and password at least 6 characters.";else{this.loading=!0,this.errorMessage="";try{const e=await D.post("/auth/login",{username:this.username.toLowerCase(),password:this.password}),{token:t,user_id:o,role:n}=e.data;localStorage.setItem("token",t),localStorage.setItem("user_id",o),localStorage.setItem("role",n),"teacher"===n?this.$router.push("/TeacherHome"):(this.errorMessage="Only teachers can log in here.",localStorage.clear())}catch(e){e.response?401===e.response.status?this.errorMessage="Invalid username or password.":this.errorMessage=e.response&&e.response.data&&e.response.data.message||"An error occurred during login.":this.errorMessage="Network error. Please check your connection."}finally{this.loading=!1}}else this.errorMessage="Please enter both username and password."}}};o("b7ca");const oo=s()(to,[["render",eo],["__scopeId","data-v-b879ec9e"]]);var no=oo;const co={class:"theme-teacher"},ao={class:"top-banner"},lo={class:"t_banner-actions"},ro={class:"center large-paragraph",style:{color:"#222"}},so=["value"],io={key:0,style:{color:"red","margin-top":"10px"}};function uo(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",co,[Object(n["createElementVNode"])("div",ao,[t[6]||(t[6]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Create New Class",-1)),Object(n["createElementVNode"])("div",lo,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[4]||(t[4]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[5]||(t[5]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",ro,[Object(n["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(n["withModifiers"])((...e)=>l.saveCourse&&l.saveCourse(...e),["prevent"]))},[t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"courseTitle"},"Course Title:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"courseTitle","onUpdate:modelValue":t[0]||(t[0]=e=>a.courseTitle=e),style:{height:"20px"}},null,512),[[n["vModelText"],a.courseTitle]]),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),t[9]||(t[9]=Object(n["createElementVNode"])("label",{for:"courseNumber"},"Course Number:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"courseNumber","onUpdate:modelValue":t[1]||(t[1]=e=>a.courseNumber=e),style:{height:"20px"}},null,512),[[n["vModelText"],a.courseNumber]]),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),t[11]||(t[11]=Object(n["createElementVNode"])("label",{for:"textbookTitle"},"Textbook Title:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{id:"textbookTitle","onUpdate:modelValue":t[2]||(t[2]=e=>a.selectedTextbookId=e),style:{height:"50px",width:"200px"},required:""},[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.textbooks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("option",{key:e.id,value:e.id},Object(n["toDisplayString"])(e.title),9,so))),128))],512),[[n["vModelSelect"],a.selectedTextbookId]]),a.textbooks.length?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",io," No textbooks available. ")),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("div",{class:"center large-heading"},[Object(n["createElementVNode"])("input",{type:"submit",value:"Save"})],-1))],32)])])}var bo={name:"TeacherNewClass",data(){return{courseTitle:"",courseNumber:"",selectedTextbookId:null,textbooks:[],error:null}},created(){this.fetchTextbooks()},methods:{async fetchTextbooks(){try{console.log("Fetching textbooks...");const e=await D.get("/textbooks/all",{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Textbooks fetched:",e.data),e.data&&e.data.textbooks?this.textbooks=e.data.textbooks:this.error="Failed to fetch textbooks data."}catch(e){console.error("Error fetching textbooks:",e),e.response?this.error=`Error: ${e.response.status} - ${e.response.data.message||e.response.statusText}`:this.error="Network error or server is not responding."}},selectTextbook(e){this.selectedTextbookId=e.id,this.selectedTextbookTitle=e.title},async saveCourse(){if(this.courseTitle&&this.courseNumber&&this.selectedTextbookId){const t={course_name:this.courseTitle,course_number:this.courseNumber,textbook_id:this.selectedTextbookId};try{const e=await D.post("/courses",t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Course saved successfully:",e.data),alert("Course saved successfully!"),this.$router.push({path:"/TeacherHome"})}catch(e){console.error("Error saving course:",e),alert("Failed to save the course. Please try again.")}}else alert("Please fill out all fields.")}}};o("31d1");const mo=s()(bo,[["render",uo],["__scopeId","data-v-64c2e3b9"]]);var po=mo;const ho={class:"theme-teacher"},Oo={class:"top-banner"},jo={class:"t_banner-actions"},No={class:"center large-paragraph",style:{color:"#222"}};function ko(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ho,[Object(n["createElementVNode"])("div",Oo,[t[6]||(t[6]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Create New Draft Pool",-1)),Object(n["createElementVNode"])("div",jo,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[4]||(t[4]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[5]||(t[5]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",No,[Object(n["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(n["withModifiers"])((...e)=>l.saveTestBank&&l.saveTestBank(...e),["prevent"]))},[t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"bankName"},"Name of Draft Pool:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankName","onUpdate:modelValue":t[0]||(t[0]=e=>a.bankName=e),style:{height:"20px"}},null,512),[[n["vModelText"],a.bankName]]),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),t[9]||(t[9]=Object(n["createElementVNode"])("br",null,null,-1)),t[10]||(t[10]=Object(n["createElementVNode"])("label",{for:"bankCh"},"Textbook Chapter:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankCh","onUpdate:modelValue":t[1]||(t[1]=e=>a.bankChapter=e),style:{height:"20px"}},null,512),[[n["vModelText"],a.bankChapter]]),t[11]||(t[11]=Object(n["createElementVNode"])("br",null,null,-1)),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("label",{for:"bankSec"},"Textbook Section:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"bankSec","onUpdate:modelValue":t[2]||(t[2]=e=>a.bankSection=e),style:{height:"20px"}},null,512),[[n["vModelText"],a.bankSection]]),t[14]||(t[14]=Object(n["createElementVNode"])("br",null,null,-1)),t[15]||(t[15]=Object(n["createElementVNode"])("br",null,null,-1)),t[16]||(t[16]=Object(n["createElementVNode"])("input",{type:"submit",value:"Submit"},null,-1))],32)])])}var go={name:"TeacherNewTB",data(){return{courseId:this.$route.query.courseId||"",courseTitle:this.$route.query.courseTitle||"",bankName:"",bankChapter:"",bankSection:""}},methods:{async saveTestBank(){if(this.bankName&&this.bankChapter&&this.bankSection&&this.courseId){const t={testbank_name:this.bankName,chapter_number:this.bankChapter,section_number:this.bankSection,course_id:this.courseId};try{const e=await D.post("/testbanks/teacher",t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Test bank saved successfully:",e.data),alert("Test bank saved successfully!"),this.$router.push({path:"/TeacherQuestions",query:{courseTitle:this.courseTitle,courseId:this.courseId}})}catch(e){console.error("Error saving test bank:",e),alert("Failed to save the test bank. Please try again.")}}else alert("Please fill out all fields.")}}};o("8bca");const Eo=s()(go,[["render",ko],["__scopeId","data-v-e206ccd2"]]);var Vo=Eo;const yo={class:"teacher-newTest-container"},wo={class:"center large-paragraph"},fo={class:"box",style:{width:"250px"}},To={class:"container"},vo={class:"box"},_o={class:"form-popup",id:"test_view"},Bo={class:"form-container"},xo={class:"r_container"},Co={class:"r_container"},So={class:"r_container"};function Do(e,t,o,c,a,l){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",yo,[t[27]||(t[27]=Object(n["createElementVNode"])("div",{class:"center large-heading sticky"},[Object(n["createElementVNode"])("h1",null,"Create Test")],-1)),Object(n["createElementVNode"])("div",wo,[Object(n["createElementVNode"])("div",fo,[Object(n["createElementVNode"])("label",To,[t[11]||(t[11]=Object(n["createTextVNode"])("Add Cover Page ")),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>a.coverPage=e)},null,512),[[n["vModelCheckbox"],a.coverPage]]),t[12]||(t[12]=Object(n["createElementVNode"])("span",{class:"checkmark"},null,-1))])]),t[15]||(t[15]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[1]||(t[1]=(...e)=>l.edit&&l.edit(...e))},"Template Options"),t[16]||(t[16]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[2]||(t[2]=(...e)=>l.importGraphic&&l.importGraphic(...e))},"Add Embedded Graphic"),t[17]||(t[17]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("div",vo,[t[13]||(t[13]=Object(n["createElementVNode"])("label",{for:"est"},"Time Allowed:",-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"est","onUpdate:modelValue":t[3]||(t[3]=e=>a.timeAllowed=e),style:{height:"20px"}},null,512),[[n["vModelText"],a.timeAllowed]]),t[14]||(t[14]=Object(n["createElementVNode"])("br",null,null,-1))]),t[18]||(t[18]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[4]||(t[4]=(...e)=>l.generateTest&&l.generateTest(...e))},"Generate Test")]),Object(n["createElementVNode"])("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:t[5]||(t[5]=(...e)=>l.handleFileUpload&&l.handleFileUpload(...e))},null,32),Object(n["createElementVNode"])("div",_o,[Object(n["createElementVNode"])("form",Bo,[t[25]||(t[25]=Object(n["createTextVNode"])(" Please select which template to use")),t[26]||(t[26]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("label",xo,[t[19]||(t[19]=Object(n["createTextVNode"])("Default ")),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",value:"Default","onUpdate:modelValue":t[6]||(t[6]=e=>a.selectedTemplate=e),name:"template"},null,512),[[n["vModelRadio"],a.selectedTemplate]]),t[20]||(t[20]=Object(n["createElementVNode"])("span",{class:"checkmark"},null,-1))]),Object(n["createElementVNode"])("label",Co,[t[21]||(t[21]=Object(n["createTextVNode"])("Mixed ")),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",value:"Mixed","onUpdate:modelValue":t[7]||(t[7]=e=>a.selectedTemplate=e),name:"template"},null,512),[[n["vModelRadio"],a.selectedTemplate]]),t[22]||(t[22]=Object(n["createElementVNode"])("span",{class:"checkmark"},null,-1))]),Object(n["createElementVNode"])("label",So,[t[23]||(t[23]=Object(n["createTextVNode"])("ETC ")),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"radio",value:"ETC","onUpdate:modelValue":t[8]||(t[8]=e=>a.selectedTemplate=e),name:"template"},null,512),[[n["vModelRadio"],a.selectedTemplate]]),t[24]||(t[24]=Object(n["createElementVNode"])("span",{class:"checkmark"},null,-1))]),Object(n["createElementVNode"])("button",{type:"button",class:"btn",onClick:t[9]||(t[9]=(...e)=>l.saveTemplate&&l.saveTemplate(...e))},"Save"),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[10]||(t[10]=(...e)=>l.closeForm&&l.closeForm(...e))},"Close")])])])}var Io={name:"TeacherNewTest",data(){return{coverPage:!0,selectedTemplate:"Default",timeAllowed:"",uploadedImage:"",showPopup:!1}},methods:{importGraphic(){document.getElementById("fileInput").click()},handleFileUpload(e){const t=e.target.files[0];t&&(console.log("File selected:",t.name),localStorage.setItem("uploadedImage",t.name),this.uploadedImage=t.name)},generateTest(){const e={coverPage:this.coverPage,selectedTemplate:this.selectedTemplate,uploadedImage:this.uploadedImage,timeAllowed:this.timeAllowed};localStorage.setItem("testOptions",JSON.stringify(e)),this.$router.push({path:"TeacherTemplate"})},edit(){document.getElementById("test_view").style.display="block"},closeForm(){document.getElementById("test_view").style.display="none"},saveTemplate(){this.closeForm()}}};o("e004");const qo=s()(Io,[["render",Do],["__scopeId","data-v-32550516"]]);var Fo=qo;const Mo={class:"theme-teacher"},Ao={class:"top-banner"},Po={class:"t_banner-actions"},Qo={class:"center large-paragraph",style:{color:"#222"}};function Uo(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Mo,[Object(n["createElementVNode"])("div",Ao,[t[4]||(t[4]=Object(n["createElementVNode"])("div",{class:"banner-title"},"Testbank Selection",-1)),Object(n["createElementVNode"])("div",Po,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[2]||(t[2]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[3]||(t[3]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",Qo,[t[5]||(t[5]=Object(n["createTextVNode"])(" Please select an option to view: ")),t[6]||(t[6]=Object(n["createElementVNode"])("br",null,null,-1)),t[7]||(t[7]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[0]||(t[0]=(...e)=>l.viewPublishedTests&&l.viewPublishedTests(...e))},"Published Tests"),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),t[9]||(t[9]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[1]||(t[1]=(...e)=>l.viewPublisherQuestions&&l.viewPublisherQuestions(...e))},"Publisher Testbank Questions")])])}var Lo={name:"TeacherPubQ",data(){return{publishedTests:[],viewing:""}},methods:{async viewPublishedTests(){},viewPublisherQuestions(){}}};o("8589");const $o=s()(Lo,[["render",Uo],["__scopeId","data-v-ecc95392"]]);var zo=$o;const Ho={class:"theme-teacher"},Ro={class:"top-banner"},Wo={class:"banner-title"},Go={class:"t_banner-actions"},Jo={class:"page-wrapper"},Xo={class:"button-row-wrapper"},Ko={class:"button-row"},Yo={class:"t_dropdown"},Zo={class:"t_dropbtn"},en={class:"t_dropdown-content"},tn=["onClick"],on={class:"t_dropdown"},nn={class:"t_dropdown-content"},cn={id:"selectedQuestionType",style:{color:"#222"},class:"center large-paragraph"},an=["onClick"],ln={key:0},rn={key:1},sn={key:2},dn={key:3},un={key:4},bn={key:5},mn={key:6,class:"button-group"},pn=["onClick"],hn=["onClick"],On=["onClick"],jn={class:"form-popup-modal"},Nn={style:{display:"flex","flex-direction":"column","align-items":"flex-start"}},kn=["onClick"],gn={class:"form-container",style:{width:"100%"}},En={class:"form-popup-modal"},Vn={key:0},yn={key:1},wn={key:2},fn=["onUpdate:modelValue"],Tn=["onUpdate:modelValue"],vn=["onClick"],_n={key:3},Bn={key:4},xn={key:5},Cn=["src"],Sn={class:"form-popup-modal"};function Dn(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ho,[Object(n["createElementVNode"])("div",Ro,[Object(n["createElementVNode"])("div",Wo,Object(n["toDisplayString"])(a.courseTitle),1),Object(n["createElementVNode"])("div",Go,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[34]||(t[34]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[35]||(t[35]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",Jo,[Object(n["createElementVNode"])("div",Xo,[Object(n["createElementVNode"])("div",Ko,[Object(n["createElementVNode"])("div",Yo,[Object(n["createElementVNode"])("button",Zo,Object(n["toDisplayString"])(e.selectedTestBank?e.selectedTestBank.name:"Select Draft Pool"),1),Object(n["createElementVNode"])("div",en,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.testBanks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:e.testbank_id,href:"#",onClick:Object(n["withModifiers"])(t=>l.selectTestBank(e),["prevent"])},Object(n["toDisplayString"])(e.name),9,tn))),128))])]),Object(n["createVNode"])(r,{to:{path:"/TeacherNewTB",query:{courseId:a.courseId}}},{default:Object(n["withCtx"])(()=>t[36]||(t[36]=[Object(n["createElementVNode"])("button",{class:"t_button"},"New Draft Pool",-1)])),_:1},8,["to"]),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[0]||(t[0]=(...e)=>l.importTest&&l.importTest(...e))},"Import Test"),Object(n["createElementVNode"])("div",on,[t[37]||(t[37]=Object(n["createElementVNode"])("button",{class:"t_dropbtn"},"Question Type",-1)),Object(n["createElementVNode"])("div",nn,[Object(n["createElementVNode"])("a",{href:"#",onClick:t[1]||(t[1]=e=>l.selectQuestionType("True/False"))},"True/False"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[2]||(t[2]=e=>l.selectQuestionType("Multiple Choice"))},"Multiple Choice"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[3]||(t[3]=e=>l.selectQuestionType("Matching"))},"Matching"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[4]||(t[4]=e=>l.selectQuestionType("Fill in the Blank"))},"Fill in the Blank"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[5]||(t[5]=e=>l.selectQuestionType("Short Answer"))},"Short Answer"),Object(n["createElementVNode"])("a",{href:"#",onClick:t[6]||(t[6]=e=>l.selectQuestionType("Essay"))},"Essay")])]),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[7]||(t[7]=e=>a.showCourseEditPopup=!0)},"Edit Course Info"),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[8]||(t[8]=(...e)=>l.edit&&l.edit(...e))},"New Question"),Object(n["createVNode"])(r,{to:"/TeacherPubQ"},{default:Object(n["withCtx"])(()=>t[38]||(t[38]=[Object(n["createElementVNode"])("button",{class:"t_button"},"Community Resources",-1)])),_:1}),t[39]||(t[39]=Object(n["createElementVNode"])("hr",null,null,-1))])]),Object(n["createElementVNode"])("div",cn,Object(n["toDisplayString"])(a.selectedQuestionType),1)]),t[89]||(t[89]=Object(n["createElementVNode"])("hr",null,null,-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.questions,(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:o,class:Object(n["normalizeClass"])(["question-box",{selected:a.selectedQuestionId===e.id}]),onClick:t=>l.toggleQuestionSelection(e.id)},[Object(n["createElementVNode"])("strong",null,"Question "+Object(n["toDisplayString"])(o+1)+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.text),1),t[54]||(t[54]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[40]||(t[40]=Object(n["createElementVNode"])("strong",null,"Type:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.type),1)]),t[55]||(t[55]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[41]||(t[41]=Object(n["createElementVNode"])("strong",null,"Chapter:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.chapter||"N/A"),1)]),t[56]||(t[56]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[42]||(t[42]=Object(n["createElementVNode"])("strong",null,"Section:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.section||"N/A"),1)]),t[57]||(t[57]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[43]||(t[43]=Object(n["createElementVNode"])("strong",null,"Points:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.points),1)]),t[58]||(t[58]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[44]||(t[44]=Object(n["createElementVNode"])("strong",null,"Estimated Time:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.time)+" minutes",1)]),t[59]||(t[59]=Object(n["createElementVNode"])("br",null,null,-1)),"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ln,[t[45]||(t[45]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer?"True":"False"),1)])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",rn,[t[46]||(t[46]=Object(n["createElementVNode"])("strong",null,"Correct Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.correctOption&&e.correctOption.option_text||"Not specified"),1),t[47]||(t[47]=Object(n["createElementVNode"])("br",null,null,-1)),t[48]||(t[48]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Other Options:")],-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.incorrectOptions,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t,class:"incorrect-answer"},Object(n["toDisplayString"])(e.option_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Short Answer"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",sn,[t[49]||(t[49]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer||"Not provided"),1)])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",dn,[t[50]||(t[50]=Object(n["createElementVNode"])("strong",null,"Correct Answer(s):",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.blanks,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.correct_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",un,[t[51]||(t[51]=Object(n["createElementVNode"])("strong",null,"Pairs:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.pairs,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.term)+" - "+Object(n["toDisplayString"])(e.definition),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Essay"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",bn,[t[52]||(t[52]=Object(n["createElementVNode"])("strong",null,"Essay Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.instructions||"None"),1)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("span",null,[t[53]||(t[53]=Object(n["createElementVNode"])("strong",null,"Grading Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.instructions||"None"),1)]),t[60]||(t[60]=Object(n["createElementVNode"])("br",null,null,-1)),a.selectedQuestionId===e.id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",mn,[Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>l.editQuestion(e),["stop"])},"Edit",8,pn),Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>l.deleteQuestion(e.id),["stop"])},"Delete",8,hn),Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>l.openAddToTestBank(e.id),["stop"])},"Add to Draft Pool",8,On)])):Object(n["createCommentVNode"])("",!0)],10,an))),128))]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"popup-overlay",onClick:t[10]||(t[10]=Object(n["withModifiers"])((...e)=>l.closeAddToTBModal&&l.closeAddToTBModal(...e),["self"]))},[Object(n["createElementVNode"])("div",jn,[t[61]||(t[61]=Object(n["createElementVNode"])("h2",null,"Select draft pool to add question to:",-1)),Object(n["createElementVNode"])("div",Nn,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.testBanks,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:e.testbank_id,style:{"margin-bottom":"10px",width:"100%"}},[Object(n["createElementVNode"])("button",{class:"t_button",style:{width:"100%"},onClick:t=>l.assignQuestionToTestBank(e.testbank_id)},Object(n["toDisplayString"])(e.name),9,kn)]))),128)),Object(n["createElementVNode"])("div",gn,[Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",style:{width:"100%"},onClick:t[9]||(t[9]=(...e)=>l.closeAddToTBModal&&l.closeAddToTBModal(...e))}," Close ")])])])],512),[[n["vShow"],a.showAddToTBModal]]),Object(n["createElementVNode"])("input",{type:"file",id:"fileInput",style:{display:"none"},onChange:t[11]||(t[11]=(...e)=>l.handleFileUpload&&l.handleFileUpload(...e))},null,32),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"popup-overlay",onClick:t[28]||(t[28]=Object(n["withModifiers"])((...e)=>l.closeForm&&l.closeForm(...e),["self"]))},[Object(n["createElementVNode"])("div",En,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[27]||(t[27]=Object(n["withModifiers"])((...e)=>l.handleQuestionSave&&l.handleQuestionSave(...e),["prevent"]))},[Object(n["createElementVNode"])("h1",null,Object(n["toDisplayString"])(a.editingQuestionId?"Edit Question":"New Question"),1),t[70]||(t[70]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Chapter Number")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[12]||(t[12]=e=>a.chapter=e),required:""},null,512),[[n["vModelText"],a.chapter]]),t[71]||(t[71]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Section Number")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[13]||(t[13]=e=>a.section=e),required:""},null,512),[[n["vModelText"],a.section]]),t[72]||(t[72]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Question Type"),Object(n["createElementVNode"])("br")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{"onUpdate:modelValue":t[14]||(t[14]=e=>a.selectedQuestionType=e),required:""},t[62]||(t[62]=[Object(n["createElementVNode"])("option",{disabled:"",value:""},"Select a type",-1),Object(n["createElementVNode"])("option",null,"True/False",-1),Object(n["createElementVNode"])("option",null,"Multiple Choice",-1),Object(n["createElementVNode"])("option",null,"Matching",-1),Object(n["createElementVNode"])("option",null,"Fill in the Blank",-1),Object(n["createElementVNode"])("option",null,"Short Answer",-1),Object(n["createElementVNode"])("option",null,"Essay",-1)]),512),[[n["vModelSelect"],a.selectedQuestionType]]),t[73]||(t[73]=Object(n["createElementVNode"])("br",null,null,-1)),t[74]||(t[74]=Object(n["createElementVNode"])("br",null,null,-1)),t[75]||(t[75]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Question Text")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=e=>a.question=e),required:""},null,512),[[n["vModelText"],a.question]]),"True/False"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Vn,[t[64]||(t[64]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{"onUpdate:modelValue":t[16]||(t[16]=e=>a.answer=e)},t[63]||(t[63]=[Object(n["createElementVNode"])("option",{value:"True"},"True",-1),Object(n["createElementVNode"])("option",{value:"False"},"False",-1)]),512),[[n["vModelSelect"],a.answer]])])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",yn,[t[65]||(t[65]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Correct Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=e=>a.answer=e)},null,512),[[n["vModelText"],a.answer]]),t[66]||(t[66]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Incorrect Answer Choices (comma-separated)")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[18]||(t[18]=e=>a.answerChoices=e)},null,512),[[n["vModelText"],a.answerChoices]])])):Object(n["createCommentVNode"])("",!0),"Matching"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",wn,[t[67]||(t[67]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Matching Pairs")],-1)),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.matchingPairs,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:t},[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t=>e.term=t,placeholder:"Term"},null,8,fn),[[n["vModelText"],e.term]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t=>e.definition=t,placeholder:"Definition"},null,8,Tn),[[n["vModelText"],e.definition]]),Object(n["createElementVNode"])("button",{type:"button",onClick:e=>l.removePair(t)},"Remove",8,vn)]))),128)),Object(n["createElementVNode"])("button",{type:"button",onClick:t[19]||(t[19]=(...e)=>l.addPair&&l.addPair(...e))},"Add Pair")])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",_n,[t[68]||(t[68]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Correct Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[20]||(t[20]=e=>a.answer=e)},null,512),[[n["vModelText"],a.answer]])])):Object(n["createCommentVNode"])("",!0),"Short Answer"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Bn,[t[69]||(t[69]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Answer")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[21]||(t[21]=e=>a.answer=e)},null,512),[[n["vModelText"],a.answer]])])):Object(n["createCommentVNode"])("",!0),"Essay"===a.selectedQuestionType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",xn)):Object(n["createCommentVNode"])("",!0),t[76]||(t[76]=Object(n["createElementVNode"])("br",null,null,-1)),t[77]||(t[77]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Points Worth")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[22]||(t[22]=e=>a.points=e),required:""},null,512),[[n["vModelText"],a.points]]),t[78]||(t[78]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Estimated Time (in minutes)")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[23]||(t[23]=e=>a.time=e),required:""},null,512),[[n["vModelText"],a.time]]),t[79]||(t[79]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Grading Instructions")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[24]||(t[24]=e=>a.instructions=e),required:""},null,512),[[n["vModelText"],a.instructions]]),t[80]||(t[80]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Upload Image")],-1)),Object(n["createElementVNode"])("input",{type:"file",onChange:t[25]||(t[25]=(...e)=>l.handleImageUpload&&l.handleImageUpload(...e)),accept:"image/*"},null,32),a.imagePreview?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:6,src:a.imagePreview,alt:"Preview",style:{"max-width":"100%"}},null,8,Cn)):Object(n["createCommentVNode"])("",!0),t[81]||(t[81]=Object(n["createElementVNode"])("br",null,null,-1)),t[82]||(t[82]=Object(n["createElementVNode"])("br",null,null,-1)),t[83]||(t[83]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Save",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[26]||(t[26]=(...e)=>l.closeForm&&l.closeForm(...e))},"Close")],32)])],512),[[n["vShow"],a.showForm]]),a.showCourseEditPopup?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"popup-overlay",onClick:t[33]||(t[33]=Object(n["withModifiers"])(e=>a.showCourseEditPopup=!1,["self"]))},[Object(n["createElementVNode"])("div",Sn,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[32]||(t[32]=Object(n["withModifiers"])((...e)=>l.saveCourseInfo&&l.saveCourseInfo(...e),["prevent"]))},[t[84]||(t[84]=Object(n["createElementVNode"])("h1",null,"Edit Course Info",-1)),t[85]||(t[85]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Course Title")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[29]||(t[29]=e=>a.editCourseTitle=e),required:""},null,512),[[n["vModelText"],a.editCourseTitle]]),t[86]||(t[86]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("b",null,"Course Number")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[30]||(t[30]=e=>a.editCourseNumber=e),required:""},null,512),[[n["vModelText"],a.editCourseNumber]]),t[87]||(t[87]=Object(n["createElementVNode"])("br",null,null,-1)),t[88]||(t[88]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Save",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[31]||(t[31]=e=>a.showCourseEditPopup=!1)},"Cancel")],32)])])):Object(n["createCommentVNode"])("",!0)])}var In={name:"TeacherQuestions",data(){return{courseTitle:this.$route.query.courseTitle||"Untitled Course",courseId:this.$route.query.courseId||null,chapter:"",section:"",question:"",reference:"",answer:"",answerChoices:"",points:"",time:"",instructions:"",image:"",imagePreview:"",selectedQuestionType:"",matchingPairs:[],questions:[],selectedQuestionId:null,editingQuestionId:null,showForm:!1,selectedTestbank:null,testBanks:[],showCourseEditPopup:!1,editCourseTitle:this.$route.query.courseTitle||"",editCourseNumber:"",showAddToTBModal:!1,questionToAddToTB:null,oldMCOptionIds:[]}},mounted(){const e=this.$route.params.id;console.log("Viewing testbank:",e),this.loadTestbanks(),this.$route.query.testBankName&&(this.selectedTestBank={name:this.$route.query.testBankName})},methods:{openAddToTestBank(e){this.questionToAddToTB=e,this.showAddToTBModal=!0},closeAddToTBModal(){this.questionToAddToTB=null,this.showAddToTBModal=!1},async assignQuestionToTestBank(e){if(this.questionToAddToTB)try{await D.post(`/testbanks/${e}/questions`,{question_ids:[this.questionToAddToTB]},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),alert("Question successfully added to testbank!"),this.closeAddToTBModal()}catch(t){console.error("Failed to add question to testbank:",t),alert("Failed to add question.")}},openCourseEditPopup(){const e=this.courseTitle.trim().split(" ");this.editCourseNumber=e.length>1?e.pop():"",this.editCourseTitle=e.join(" "),this.showCourseEditPopup=!0},async saveCourseInfo(){try{await D.patch("/courses/"+this.courseId,{course_name:this.editCourseTitle,course_number:this.editCourseNumber},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});const e=`${this.editCourseTitle} ${this.editCourseNumber}`.trim();this.courseTitle=e,document.title=e,this.showCourseEditPopup=!1,alert("Course info updated successfully.")}catch(e){console.error("Failed to update course:",e),alert("Failed to update course.")}},async loadTestbanks(){try{const e=await D.get("/testbanks/teacher?course_id="+this.courseId,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.testBanks=e.data.testbanks}catch(e){console.error("Failed to load teacher testbanks:",e)}},selectTestBank(e){this.selectedTestBank=e,this.selectedTestbankId=e.value,this.$router.push({name:"TeacherViewTB",params:{id:e.testbank_id},query:{courseId:this.courseId,courseTitle:this.courseTitle,testBankName:e.name}})},async fetchQuestions(e){this.selectedQuestionType=e;try{const t=await D.get("/questions",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{course_id:this.$route.query.courseId,type:e}});console.log("Questions fetched:",t.data),Array.isArray(t.data.questions)?this.questions=t.data.questions.map(e=>{const t={text:e.question_text,type:e.type,points:e.default_points,id:e.id,instructions:e.grading_instructions||"",time:e.est_time,chapter:e.chapter_number,section:e.section_number};switch(e.type){case"True/False":return{...t,answer:e.true_false_answer};case"Multiple Choice":return{...t,correctOption:e.correct_option||null,incorrectOptions:e.incorrect_options||[]};case"Matching":return{...t,pairs:(e.matches||[]).map(e=>({match_id:e.match_id,term:e.prompt_text,definition:e.match_text}))};case"Fill in the Blank":return{...t,blanks:e.blanks||[],instructions:e.grading_instructions||""};case"Short Answer":return{...t,answer:e.answer||""};case"Essay":return{...t,instructions:e.instructions||""};default:return t}}):this.questions=[]}catch(t){console.error("Error fetching questions:",t),this.questions=[]}},displayQuestionType(e){this.selectedQuestionType="Selected Question Type: "+e},created(){console.log("Query Parameters:",this.$route.query)},importTest(){document.getElementById("fileInput").click()},async handleFileUpload(e){const t=e.target.files[0];if(!t)return void alert("No file selected.");const o=new FormData;o.append("file",t);try{const e=await D.post("/qti/upload",o,{headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"multipart/form-data"}}),t=e.data.file_path;console.log("File uploaded successfully:",t);const n=await D.post("/qti/import",{file_path:t},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),c=n.data.import_id;console.log("QTI import created. Import ID:",c);const a=await D.post("qti/save/"+c,{course_id:this.courseId},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});alert(a.data.message||"Questions imported successfully!"),console.log("Questions imported successfully:",a.data),this.fetchQuestions(this.selectedQuestionType)}catch(n){console.error("QTI import Failed:",n),alert("Failed to upload file. Please try again.")}},async handleQuestionSave(){try{let e,t;const o=this.questions.find(e=>e.id===this.editingQuestionId),n=!!this.editingQuestionId,c={question_text:this.question,default_points:parseInt(this.points),est_time:parseInt(this.time),chapter_number:this.chapter,section_number:this.section,grading_instructions:this.instructions,type:this.selectedQuestionType,source:"manual",course_id:this.courseId};let a=[];if("Multiple Choice"===this.selectedQuestionType){const e=this.answerChoices.split(",").map(e=>e.trim()).filter(Boolean),t=this.answer.trim();if(!t)return void alert("Correct answer cannot be empty.");if(a.push({option_text:t,is_correct:!0}),e.forEach(e=>{a.push({option_text:e,is_correct:!1})}),!a.some(e=>e.is_correct))return void alert("Multiple Choice questions must have at least one correct answer.")}if(this.image){e=new FormData,e.append("file",this.image);for(const[t,o]of Object.entries(c))e.append(t,o);switch(this.selectedQuestionType){case"True/False":e.append("true_false_answer","True"===this.answer);break;case"Multiple Choice":e.append("options",JSON.stringify(a)),n&&this.oldMCOptionIds.length>0&&e.append("to_delete",JSON.stringify(this.oldMCOptionIds));break;case"Matching":if(e.append("matches",JSON.stringify(this.matchingPairs.map(e=>({prompt_text:e.term,match_text:e.definition})))),n&&o){const t=(o.pairs||[]).map(e=>e.match_id);e.append("to_delete",JSON.stringify(t))}break;case"Fill in the Blank":if(e.append("blanks",JSON.stringify([{correct_text:this.answer}])),n&&o){const t=(o.blanks||[]).map(e=>e.blank_id);e.append("to_delete",JSON.stringify(t))}break;case"Short Answer":e.append("answer",this.answer);break;case"Essay":e.append("grading_instructions",this.instructions);break}t={headers:{Authorization:"Bearer "+localStorage.getItem("token"),"Content-Type":"multipart/form-data"}}}else{switch(e={...c},this.selectedQuestionType){case"True/False":e.true_false_answer="True"===this.answer;break;case"Multiple Choice":e.options=a,n&&this.oldMCOptionIds.length>0&&(e.to_delete=this.oldMCOptionIds);break;case"Matching":if(e.matches=this.matchingPairs.map(e=>({prompt_text:e.term,match_text:e.definition})),n&&o){const t=(o.pairs||[]).map(e=>e.match_id);e.to_delete=t}break;case"Fill in the Blank":if(e.blanks=[{correct_text:this.answer}],n&&o){const t=(o.blanks||[]).map(e=>e.blank_id);e.to_delete=t}break;case"Short Answer":e.answer=this.answer;break;case"Essay":e.grading_instructions=this.instructions;break}t={headers:{Authorization:"Bearer "+localStorage.getItem("token")}}}n?await D.patch("/questions/"+this.editingQuestionId,e,t):await D.post("/questions",e,t),alert("Question saved successfully!"),this.closeForm(),this.resetForm(),this.fetchQuestions(this.selectedQuestionType)}catch(e){let t="Something went wrong.";e&&e.response&&e.response.data&&(t=e.response.data.error||e.response.data.message||t),alert("Save failed: "+t),console.error("Error saving question:",e)}},selectQuestionType(e){this.selectedQuestionType="Selected Question Type: "+e,this.fetchQuestions(e)},edit(){this.showForm=!0},closeForm(){this.showForm=!1},addPair(){this.matchingPairs.push({term:"",definition:""})},removePair(e){this.matchingPairs.splice(e,1)},handleImageUpload(e){const t=e.target.files[0];if(t){this.image=t;const e=new FileReader;e.onload=e=>{this.imagePreview=e.target.result},e.readAsDataURL(t)}},resetForm(){this.chapter="",this.section="",this.question="",this.reference="",this.answer="",this.answerChoices="",this.points="",this.time="",this.instructions="",this.image="",this.imagePreview="",this.matchingPairs=[],this.selectedQuestionType="",this.editingQuestionId=null,this.image="",this.imagePreview=""},editQuestion(e){this.editingQuestionId=e.id,this.question=e.text,this.chapter=e.chapter,this.section=e.section,this.points=e.points,this.time=e.time,this.instructions=e.instructions,this.answer=e.answer||"",this.selectedQuestionType=e.type,"Multiple Choice"===e.type?(this.answer=e.correctOption&&e.correctOption.option_text||"",this.answerChoices=(e.incorrectOptions||[]).map(e=>e.option_text).join(", "),this.oldMCOptionIds=[],e.correctOption&&e.correctOption.option_id&&this.oldMCOptionIds.push(e.correctOption.option_id),Array.isArray(e.incorrectOptions)&&e.incorrectOptions.forEach(e=>{e.option_id&&this.oldMCOptionIds.push(e.option_id)})):"Matching"===e.type&&(this.matchingPairs=(e.pairs||[]).map(e=>({term:e.term,definition:e.definition}))),this.showForm=!0;const t=document.getElementById("q_edit");t&&t.style&&(t.style.display="block")},toggleQuestionSelection(e){this.selectedQuestionId=this.selectedQuestionId===e?null:e},async deleteQuestion(e){if(confirm("Are you sure you want to delete this question?"))try{await D.delete("/questions/"+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.questions=this.questions.filter(t=>t.id!==e),alert("Question deleted.")}catch(t){console.error(t),alert("Failed to delete question.")}}}};o("ab80");const qn=s()(In,[["render",Dn],["__scopeId","data-v-7f49a606"]]);var Fn=qn;const Mn={class:"theme-teacher"},An={class:"top-banner"},Pn={class:"banner-title"},Qn={class:"t_banner-actions"},Un={class:"center button-row"},Ln={class:"export-note"},$n={class:"export-note"},zn={class:"form-popup-modal"},Hn={class:"form-container"},Rn={style:{display:"flex","justify-content":"center",gap:"10px","margin-top":"20px"}},Wn={class:"question-list-container"},Gn={class:"question-box"},Jn={class:"drag-header"},Xn={key:0},Kn={type:"A"},Yn={class:"question-type-label"},Zn={key:1},ec={class:"correct-answer-display"},tc={class:"question-type-label"},oc={key:2},nc={class:"matching-container"},cc={class:"matching-prompts"},ac={class:"matching-answers"},lc={class:"matching-footer"},rc={class:"correct-answer-display"},sc={class:"question-type-label"},ic={key:3},dc={class:"correct-answer-display"},uc={class:"question-type-label"},bc={key:4},mc={class:"correct-answer-display"},pc={class:"question-type-label"},hc={key:5};function Oc(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link"),s=Object(n["resolveComponent"])("draggable");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Mn,[Object(n["createElementVNode"])("div",An,[Object(n["createElementVNode"])("div",Pn,Object(n["toDisplayString"])(a.testOptions.testName||"Test Template"),1),Object(n["createElementVNode"])("div",Qn,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[7]||(t[7]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[8]||(t[8]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",Un,[Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[0]||(t[0]=(...t)=>e.publishTest&&e.publishTest(...t))},"Publish Final Test"),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[1]||(t[1]=e=>a.showBackWarning=!0)},"Back to Draft Pool"),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[2]||(t[2]=(...e)=>l.exportToWord&&l.exportToWord(...e))},"Export Test to Document")]),t[20]||(t[20]=Object(n["createElementVNode"])("p",{class:"export-note"},[Object(n["createElementVNode"])("strong",null,"Note:"),Object(n["createTextVNode"])(" Anything displayed in "),Object(n["createElementVNode"])("span",{class:"green-text"},"green"),Object(n["createTextVNode"])(" will not appear on the student test but will be included in the test key. "),Object(n["createElementVNode"])("br"),Object(n["createTextVNode"])(" If selected, a cover page and any uploaded graphic will be added automatically to the exported document. ")],-1)),Object(n["createElementVNode"])("p",Ln,[t[9]||(t[9]=Object(n["createElementVNode"])("strong",null,"Total Test Time:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(l.totalEstimatedTime)+" minutes ",1)]),Object(n["createElementVNode"])("p",$n,[t[10]||(t[10]=Object(n["createElementVNode"])("strong",null,"Total Points:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(this.questions.length)+" points ",1)]),t[21]||(t[21]=Object(n["createElementVNode"])("hr",null,null,-1)),a.showBackWarning?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"popup-overlay",onClick:t[5]||(t[5]=Object(n["withModifiers"])(e=>a.showBackWarning=!1,["self"]))},[Object(n["createElementVNode"])("div",zn,[Object(n["createElementVNode"])("div",Hn,[t[11]||(t[11]=Object(n["createElementVNode"])("h2",{style:{"text-align":"center"}},"Warning",-1)),t[12]||(t[12]=Object(n["createElementVNode"])("p",{style:{"text-align":"center","font-size":"18px"}}," If you go back to the Draft Pool, any unsaved changes on this page may be lost. ",-1)),Object(n["createElementVNode"])("div",Rn,[Object(n["createElementVNode"])("button",{class:"btn",onClick:t[3]||(t[3]=(...e)=>l.confirmBack&&l.confirmBack(...e))},"Continue"),Object(n["createElementVNode"])("button",{class:"btn cancel",onClick:t[4]||(t[4]=e=>a.showBackWarning=!1)},"Cancel")])])])])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",Wn,[Object(n["createVNode"])(s,{modelValue:a.questions,"onUpdate:modelValue":t[6]||(t[6]=e=>a.questions=e),"item-key":"id",class:"drag-list",handle:".drag-handle",onUpdate:l.saveOrder},{header:Object(n["withCtx"])(()=>t[13]||(t[13]=[])),item:Object(n["withCtx"])(({element:e,index:o})=>[Object(n["createElementVNode"])("div",Gn,[Object(n["createElementVNode"])("div",Jn,[t[14]||(t[14]=Object(n["createElementVNode"])("span",{class:"drag-handle",title:"Drag to reorder"},"",-1)),Object(n["createElementVNode"])("h3",null,Object(n["toDisplayString"])(o+1)+". "+Object(n["toDisplayString"])(e.question_text),1)]),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Xn,[Object(n["createElementVNode"])("ol",Kn,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.shuffleOptions(e),(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:e.option_id||t,class:Object(n["normalizeClass"])({"correct-answer":e.is_correct})},Object(n["toDisplayString"])(e.option_text),3))),128))]),Object(n["createElementVNode"])("div",Yn,Object(n["toDisplayString"])(e.type),1)])):"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Zn,[t[15]||(t[15]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Answer:"),Object(n["createTextVNode"])(" __________________________")],-1)),Object(n["createElementVNode"])("p",ec," Correct Answer: "+Object(n["toDisplayString"])(e.blanks.map(e=>e.correct_text).join(", ")),1),Object(n["createElementVNode"])("div",tc,Object(n["toDisplayString"])(e.type),1)])):"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",oc,[Object(n["createElementVNode"])("div",nc,[Object(n["createElementVNode"])("div",cc,[t[16]||(t[16]=Object(n["createElementVNode"])("h4",null,"Match the following:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.getShuffledMatches(e),(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(t+1)+". "+Object(n["toDisplayString"])(e.prompt_text),1))),128))])]),Object(n["createElementVNode"])("div",ac,[t[17]||(t[17]=Object(n["createElementVNode"])("h4",null,"Answer Bank:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(l.getShuffledAnswerBank(e),(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(String.fromCharCode(65+t))+". "+Object(n["toDisplayString"])(e),1))),128))])])]),Object(n["createElementVNode"])("div",lc,[Object(n["createElementVNode"])("p",rc," Correct Matches: "+Object(n["toDisplayString"])(l.getMatchingKeyString(e)),1),Object(n["createElementVNode"])("div",sc,Object(n["toDisplayString"])(e.type),1)])])):"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ic,[t[18]||(t[18]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Answer:"),Object(n["createTextVNode"])(" __________________________")],-1)),Object(n["createElementVNode"])("p",dc," Correct Answer: "+Object(n["toDisplayString"])(e.true_false_answer?"True":"False"),1),Object(n["createElementVNode"])("div",uc,Object(n["toDisplayString"])(e.type),1)])):"Short Answer"===e.type||"Essay"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",bc,[Object(n["createElementVNode"])("p",mc," Grading Instructions: "+Object(n["toDisplayString"])(e.grading_instructions||"None provided"),1),Object(n["createElementVNode"])("div",pc,Object(n["toDisplayString"])(e.type),1)])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",hc,[Object(n["createElementVNode"])("em",null,"Type: "+Object(n["toDisplayString"])(e.type),1)]))])]),footer:Object(n["withCtx"])(()=>t[19]||(t[19]=[])),_:1},8,["modelValue","onUpdate"])])])}var jc=o("b76a"),Nc=o.n(jc),kc=o("21a6"),gc={components:{draggable:Nc.a},data(){const e=JSON.parse(localStorage.getItem("testOptions")||"{}");return{questions:[],testOptions:{testName:e.testName||this.$route.query.testBankName||"Test Template",coverPage:e.coverPage||!1,selectedTemplate:e.selectedTemplate||"All Questions",uploadedImage:e.uploadedImage||"",graphicPreview:e.graphicPreview||""},testBankId:this.$route.query.testBankId,showBackWarning:!1}},mounted(){this.fetchQuestions()},watch:{questions:{deep:!0,handler(e){const t=e.map(e=>e.id);localStorage.setItem("questionOrder_"+this.testBankId,JSON.stringify(t))}}},computed:{totalEstimatedTime(){return this.questions.reduce((e,t)=>{const o=parseInt(t.est_time,10);return e+(isNaN(o)?0:o)},0)}},methods:{confirmBack(){this.showBackWarning=!1,this.goBackTB()},goBackTB(){this.$router.push({name:"TeacherViewTB",params:{id:this.testBankId},query:{courseId:this.$route.query.courseId,courseTitle:this.$route.query.courseTitle,testBankName:this.$route.query.testBankName}})},async fetchQuestions(){try{const e=await D.get("/tests/draft-questions",{params:{test_bank_id:this.testBankId,type:this.testOptions.selectedTemplate||"All Questions"},headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),t=e.data.questions||[],o=localStorage.getItem("questionOrder_"+this.testBankId);if(o){const e=JSON.parse(o),n=new Map(t.map(e=>[e.id,e])),c=e.map(e=>n.get(e)).filter(Boolean);t.forEach(t=>{e.includes(t.id)||c.push(t)}),this.questions=c}else this.questions=t}catch(e){console.error("Failed to fetch questions:",e)}},saveOrder(){const e=this.questions.map(e=>e.id);localStorage.setItem("questionOrder_"+this.testBankId,JSON.stringify(e))},shuffleOptions(e){const t=[...e.incorrect_options,e.correct_option].map(e=>({...e,is_correct:!!e.is_correct}));for(let o=t.length-1;o>0;o--){const e=Math.floor(Math.random()*(o+1));[t[o],t[e]]=[t[e],t[o]]}return t},shuffleArray(e){const t=[...e];for(let o=t.length-1;o>0;o--){const e=Math.floor(Math.random()*(o+1));[t[o],t[e]]=[t[e],t[o]]}return t},getShuffledBlanks(e){return this.shuffleArray(e.blanks||[])},getShuffledMatches(e){const t=e.matches||[],o=t.map(e=>e.prompt_text),n=this.getShuffledAnswerBank(e);return o.map((e,t)=>({prompt_text:e,match_text:n[t]}))},getShuffledAnswerBank(e){if(!e._shuffledAnswers){const t=e.matches||[],o=this.shuffleArray(t.map(e=>e.match_text));e._shuffledAnswers=o}return e._shuffledAnswers},getMatchingKeyString(e){const t=this.getShuffledAnswerBank(e);return(e.matches||[]).map((e,o)=>{const n=t.findIndex(t=>t===e.match_text);return`${o+1}  ${String.fromCharCode(65+n)}`}).join(", ")},async exportToWord(){const{Document:e,Packer:t,Paragraph:n,TextRun:c,ImageRun:a,Table:l,TableRow:r,TableCell:s,HeadingLevel:i,AlignmentType:d,BorderStyle:u,ThematicBreak:b,WidthType:m}=await o.e("chunk-2d0d6e77").then(o.bind(null,"7514")),p=()=>new n(new b),h=new n({children:[],pageBreakBefore:!0}),O=()=>{const e=[new n({text:this.testOptions.testName,heading:i.TITLE,alignment:d.CENTER,spacing:{after:200}}),new n({text:"Version: XXXX",heading:i.HEADING_1,alignment:d.CENTER,spacing:{after:200}}),new n({text:"Name: __________________________",spacing:{after:400}}),new n({text:"Date: __________________________",spacing:{after:400}}),new n({text:"Course: "+(this.$route.query.courseTitle||"N/A")}),new n({text:"Time Allowed: "+(this.totalEstimatedTime||"N/A")+" minutes",spacing:{after:400}}),p(),new n({text:"Instructions:",heading:i.HEADING_2,spacing:{after:100}}),...[`This exam is worth ${this.questions.length} points.`,`You have ${this.totalEstimatedTime||"N/A"} minutes to complete the exam.`,"Read each question carefully.","Be sure to answer all questions, do not leave anything blank.","Turn in all work and scratch paper with your exam.","You may not use any external materials unless permitted by the instructor.","This exam is closed-book, closed-notes, and no external devices or help.","Check your work before submitting."].map(e=>new n({text:e,bullet:{level:0},spacing:{after:100}})),h];return e},j=()=>{const e=[new n({text:this.testOptions.testName+" - Version: XXXX",heading:i.HEADING_1,spacing:{after:300}}),new n({text:"Name: __________________________",spacing:{after:400}}),p()];return this.questions.forEach((t,o)=>{if(e.push(new n({text:`${o+1}. ${t.question_text}`,spacing:{after:200}})),"Multiple Choice"===t.type){const o=this.shuffleOptions(t);o.forEach((t,o)=>{e.push(new n({text:`${String.fromCharCode(65+o)}. ${t.option_text}`,indent:{left:720},spacing:{after:100}}))})}else if("True/False"===t.type)e.push(new n("True/False: __________________________"));else if("Fill in the Blank"===t.type)e.push(new n("Blank: _____________________"));else if("Short Answer"===t.type)for(let c=0;c<15;c++)e.push(new n(" "));else if("Essay"===t.type)for(let c=0;c<30;c++)e.push(new n(" "));else if("Matching"===t.type){e.push(new n({spacing:{after:200}}));const o=this.getShuffledMatches(t),c=(this.getShuffledAnswerBank(t),o.map((e,t)=>{const o=`${t+1}. ${e.prompt_text}`,c=`${String.fromCharCode(65+t)}. ${e.match_text}`;return new r({children:[new s({width:{size:50,type:m.PERCENTAGE},children:[new n({text:o,spacing:{after:150}})],margins:{top:100,bottom:100}}),new s({width:{size:50,type:m.PERCENTAGE},children:[new n({text:c,spacing:{after:150}})],margins:{top:100,bottom:100}})]})}));e.push(new l({rows:c,width:{size:100,type:m.PERCENTAGE},borders:{top:{style:u.NONE,size:0,color:"FFFFFF"},bottom:{style:u.NONE,size:0,color:"FFFFFF"},left:{style:u.NONE,size:0,color:"FFFFFF"},right:{style:u.NONE,size:0,color:"FFFFFF"},insideHorizontal:{style:u.NONE,size:0,color:"FFFFFF"},insideVertical:{style:u.NONE,size:0,color:"FFFFFF"}}})),e.push(new n({text:" ",spacing:{after:300}}))}e.push(new n({text:" ",spacing:{after:300}}))}),e},N=()=>{const e=[new n({children:[new c({text:this.testOptions.testName+" - Test Key",bold:!0,size:32,color:"FF0000"})],spacing:{after:300}})];return this.questions.forEach((t,o)=>{let a="";if("Multiple Choice"===t.type){const e=this.shuffleOptions(t),o=e.findIndex(e=>e.is_correct);a=`Correct Answer: ${String.fromCharCode(65+o)}. ${e[o].option_text}`}else"True/False"===t.type?a="Correct Answer: "+(t.true_false_answer?"True":"False"):"Fill in the Blank"===t.type?a="Correct Answer: "+t.blanks.map(e=>e.correct_text).join(", "):"Short Answer"===t.type||"Essay"===t.type?a="Grading Instructions: "+(t.grading_instructions||"None"):"Matching"===t.type&&(a="Correct Matches: "+this.getMatchingKeyString(t));e.push(new n({text:`${o+1}. ${t.question_text}`,spacing:{after:100}}),new n({children:[new c({text:a,color:"FF0000"})],spacing:{after:300}}))}),e},k=async()=>{const e=[];if(this.testOptions.graphicPreview)try{const t=this.testOptions.graphicPreview.split(",")[1],o=window.atob(t),c=new Uint8Array(o.length);for(let e=0;e<o.length;e++)c[e]=o.charCodeAt(e);e.push(new n({children:[],pageBreakBefore:!0}),new n({text:"Resource Page",heading:i.HEADING_1,spacing:{after:300}}),new n({children:[new a({data:c,transformation:{width:500,height:300}})],spacing:{after:300}}))}catch(t){console.error(" Failed to load image for resource page:",t),e.push(new n(" Could not load the uploaded image."))}return e},g=await k(),E=new e({sections:[{properties:{},children:[...O(),...j(),...g]}],styles:{default:{document:{run:{font:"Arial",size:24}}}}}),V=new e({sections:[{properties:{},children:N()}],styles:{default:{document:{run:{font:"Arial",size:24}}}}}),[y,w]=await Promise.all([t.toBlob(E),t.toBlob(V)]);Object(kc["saveAs"])(y,(this.testOptions.testName||"GeneratedTest")+".docx"),Object(kc["saveAs"])(w,(this.testOptions.testName||"TestKey")+".key.docx")}}};o("b6e6");const Ec=s()(gc,[["render",Oc],["__scopeId","data-v-282543b6"]]);var Vc=Ec;const yc={class:"theme-teacher"},wc={class:"top-banner"},fc={class:"banner-title"},Tc={class:"t_banner-actions"},vc={class:"center large-paragraph",style:{color:"#222"}},_c={class:"button-row"},Bc={key:0,class:"popup-overlay"},xc={class:"form-popup-modal"},Cc={class:"form-popup-modal"},Sc={class:"checkbox-label"},Dc={class:"button-group"},Ic={key:0,style:{"margin-top":"10px"}},qc=["src"],Fc=["onClick"],Mc={key:0},Ac={key:1},Pc={key:2},Qc={key:3},Uc={key:4},Lc={key:5},$c={key:6,class:"button-group"},zc=["onClick"];function Hc(e,t,o,c,a,l){const r=Object(n["resolveComponent"])("router-link");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",yc,[Object(n["createElementVNode"])("div",wc,[Object(n["createElementVNode"])("div",fc,"Test Draft: "+Object(n["toDisplayString"])(a.testBankName),1),Object(n["createElementVNode"])("div",Tc,[Object(n["createVNode"])(r,{to:"/TeacherHome",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[17]||(t[17]=[Object(n["createTextVNode"])("Home")])),_:1}),Object(n["createVNode"])(r,{to:"/",class:"t_banner-btn"},{default:Object(n["withCtx"])(()=>t[18]||(t[18]=[Object(n["createTextVNode"])("Log Out")])),_:1})])]),Object(n["createElementVNode"])("div",vc,[Object(n["createElementVNode"])("div",_c,[Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[0]||(t[0]=e=>a.showEditForm=!0)},"Edit Draft Pool Info"),Object(n["createVNode"])(r,{to:{path:"/TeacherQuestions",query:{courseTitle:a.courseTitle,courseId:a.courseId}}},{default:Object(n["withCtx"])(()=>t[19]||(t[19]=[Object(n["createElementVNode"])("button",{class:"t_button"},"Return to Question Page",-1)])),_:1},8,["to"]),t[20]||(t[20]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[1]||(t[1]=e=>a.showCreateTestWarning=!0)},"Create New Test"),Object(n["createElementVNode"])("button",{class:"t_button",onClick:t[2]||(t[2]=(...e)=>l.viewPrevious&&l.viewPrevious(...e))},"View Previous Tests"),t[21]||(t[21]=Object(n["createElementVNode"])("br",null,null,-1))]),t[53]||(t[53]=Object(n["createElementVNode"])("hr",null,null,-1)),a.showEditForm?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Bc,[Object(n["createElementVNode"])("div",xc,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[7]||(t[7]=Object(n["withModifiers"])((...e)=>l.updateTestBank&&l.updateTestBank(...e),["prevent"]))},[t[22]||(t[22]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Draft Pool Name:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>a.editForm.name=e),required:""},null,512),[[n["vModelText"],a.editForm.name]]),t[23]||(t[23]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Chapter Number:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>a.editForm.chapter=e),required:""},null,512),[[n["vModelText"],a.editForm.chapter]]),t[24]||(t[24]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Section Number:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>a.editForm.section=e),required:""},null,512),[[n["vModelText"],a.editForm.section]]),t[25]||(t[25]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Save Changes",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[6]||(t[6]=e=>a.showEditForm=!1)},"Cancel")],32)])])):Object(n["createCommentVNode"])("",!0),a.showCreateTestWarning?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:1,class:"popup-overlay",onClick:t[16]||(t[16]=Object(n["withModifiers"])(e=>a.showCreateTestWarning=!1,["self"]))},[Object(n["createElementVNode"])("div",Cc,[Object(n["createElementVNode"])("form",{class:"form-container",onSubmit:t[15]||(t[15]=Object(n["withModifiers"])((...e)=>l.goToCreateTest&&l.goToCreateTest(...e),["prevent"]))},[t[28]||(t[28]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Test Name:")],-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=e=>a.testOptions.testName=e),placeholder:"Enter a name for this test",required:""},null,512),[[n["vModelText"],a.testOptions.testName]]),Object(n["createElementVNode"])("label",Sc,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=e=>a.testOptions.coverPage=e)},null,512),[[n["vModelCheckbox"],a.testOptions.coverPage]]),t[26]||(t[26]=Object(n["createTextVNode"])(" Add a cover page "))]),t[29]||(t[29]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Select Template:")],-1)),Object(n["createElementVNode"])("div",Dc,[Object(n["createElementVNode"])("button",{type:"button",class:Object(n["normalizeClass"])({active:"All Questions"===a.testOptions.selectedTemplate}),onClick:t[10]||(t[10]=e=>a.testOptions.selectedTemplate="All Questions")}," All Questions ",2),Object(n["createElementVNode"])("button",{type:"button",class:Object(n["normalizeClass"])({active:"Multiple Choice"===a.testOptions.selectedTemplate}),onClick:t[11]||(t[11]=e=>a.testOptions.selectedTemplate="Multiple Choice")}," Multiple Choice ",2),Object(n["createElementVNode"])("button",{type:"button",class:Object(n["normalizeClass"])({active:"Short Answer/Essay"===a.testOptions.selectedTemplate}),onClick:t[12]||(t[12]=e=>a.testOptions.selectedTemplate="Short Answer/Essay")}," Short Answer/Essay ",2)]),t[30]||(t[30]=Object(n["createElementVNode"])("label",null,[Object(n["createElementVNode"])("strong",null,"Embedded Graphic:")],-1)),Object(n["createElementVNode"])("input",{type:"file",accept:"image/*",onChange:t[13]||(t[13]=(...e)=>l.handleGraphicUpload&&l.handleGraphicUpload(...e))},null,32),a.testOptions.graphicPreview?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ic,[t[27]||(t[27]=Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("strong",null,"Preview:")],-1)),Object(n["createElementVNode"])("img",{src:a.testOptions.graphicPreview,alt:"Uploaded Graphic Preview",style:{"max-width":"100%","max-height":"200px",border:"1px solid #ccc"}},null,8,qc)])):Object(n["createCommentVNode"])("",!0),t[31]||(t[31]=Object(n["createElementVNode"])("button",{type:"submit",class:"btn"},"Yes, Continue",-1)),Object(n["createElementVNode"])("button",{type:"button",class:"btn cancel",onClick:t[14]||(t[14]=e=>a.showCreateTestWarning=!1)},"Cancel")],32)])])):Object(n["createCommentVNode"])("",!0),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(a.selectedQuestions,(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:e.id,class:Object(n["normalizeClass"])(["question-box",{selected:a.selectedQuestionId===e.id}]),onClick:t=>l.toggleQuestionSelection(e.id)},[Object(n["createElementVNode"])("strong",null,"Question "+Object(n["toDisplayString"])(o+1)+":",1),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.question_text),1),t[46]||(t[46]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[32]||(t[32]=Object(n["createElementVNode"])("strong",null,"Type:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.type),1)]),t[47]||(t[47]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[33]||(t[33]=Object(n["createElementVNode"])("strong",null,"Chapter:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.chapter_number||"N/A"),1)]),t[48]||(t[48]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[34]||(t[34]=Object(n["createElementVNode"])("strong",null,"Section:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.section_number||"N/A"),1)]),t[49]||(t[49]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[35]||(t[35]=Object(n["createElementVNode"])("strong",null,"Points:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.default_points),1)]),t[50]||(t[50]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("span",null,[t[36]||(t[36]=Object(n["createElementVNode"])("strong",null,"Estimated Time:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.est_time)+" minutes",1)]),t[51]||(t[51]=Object(n["createElementVNode"])("br",null,null,-1)),"True/False"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Mc,[t[37]||(t[37]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.true_false_answer?"True":"False"),1)])):Object(n["createCommentVNode"])("",!0),"Multiple Choice"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ac,[t[38]||(t[38]=Object(n["createElementVNode"])("strong",null,"Correct Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.correct_option&&e.correct_option.option_text||"Not specified"),1),t[39]||(t[39]=Object(n["createElementVNode"])("br",null,null,-1)),t[40]||(t[40]=Object(n["createElementVNode"])("strong",null,"Other Options:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.incorrect_options||[],(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.option_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Matching"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Pc,[t[41]||(t[41]=Object(n["createElementVNode"])("strong",null,"Pairs:",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.matches||[],(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.prompt_text)+" - "+Object(n["toDisplayString"])(e.match_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Fill in the Blank"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Qc,[t[42]||(t[42]=Object(n["createElementVNode"])("strong",null,"Correct Answer(s):",-1)),Object(n["createElementVNode"])("ul",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.blanks||[],(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:t},Object(n["toDisplayString"])(e.correct_text),1))),128))])])):Object(n["createCommentVNode"])("",!0),"Short Answer"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Uc,[t[43]||(t[43]=Object(n["createElementVNode"])("strong",null,"Answer:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.answer||"Not provided"),1)])):Object(n["createCommentVNode"])("",!0),"Essay"===e.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Lc,[t[44]||(t[44]=Object(n["createElementVNode"])("strong",null,"Essay Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.grading_instructions||"None"),1)])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("span",null,[t[45]||(t[45]=Object(n["createElementVNode"])("strong",null,"Grading Instructions:",-1)),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.grading_instructions||"None"),1)]),a.selectedQuestionId===e.id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",$c,[Object(n["createElementVNode"])("button",{onClick:Object(n["withModifiers"])(t=>l.removeQuestionFromTestBank(e.id),["stop"])},"Remove",8,zc)])):Object(n["createCommentVNode"])("",!0),t[52]||(t[52]=Object(n["createElementVNode"])("hr",null,null,-1))],10,Fc))),128))])])}var Rc={name:"TeacherViewTB",data(){return{showPopup:!1,showEditForm:!1,showEditQuestionForm:!1,showCreateTestWarning:!1,testFiles:[],selectedQuestions:[],selectedQuestionId:null,editingQuestionData:{},editingQuestionId:null,courseId:this.$route.query.courseId||"",courseTitle:this.$route.query.courseTitle||"",testBankId:this.$route.params.id||"",testBankName:this.$route.query.testBankName||"",editForm:{name:this.$route.query.testBankName||"",chapter:"",section:""},testOptions:{testName:"",coverPage:!1,selectedTemplate:"",graphicFile:null,graphicFileName:"",graphicPreview:""}}},mounted(){this.initialize()},methods:{async viewPrevious(){try{const e=await D.get("/tests",{headers:{Authorization:"Bearer "+localStorage.getItem("token")},params:{course_id:this.courseId,testbank_id:this.testBankId}});this.testFiles=e.data.tests||[],this.showPopup=!0}catch(e){console.error("Failed to fetch tests:",e),alert("Could not load previous tests.")}},closeForm(){this.showPopup=!1},async fetchQuestions(){if(this.testBankId)try{const e=await D.get(`/testbanks/${this.testBankId}/questions`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("Fetched questions:",e.data.questions),this.selectedQuestions=e.data.questions||[]}catch(e){console.error("Error fetching questions for test bank:",e),this.selectedQuestions=[]}},toggleQuestionSelection(e){this.selectedQuestionId=this.selectedQuestionId===e?null:e},async removeQuestionFromTestBank(e){if(confirm("Are you sure you want to remove this question from the test bank?"))try{await D.delete(`/testbanks/${this.testBankId}/questions/${e}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.selectedQuestions=this.selectedQuestions.filter(t=>t.id!==e),alert("Question removed from test bank.")}catch(t){console.error("Error removing question:",t),alert("Failed to remove question from test bank.")}},async updateTestBank(){try{await D.put("/testbanks/teacher/"+this.testBankId,{name:this.editForm.name,chapter_number:this.editForm.chapter,section_number:this.editForm.section},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),this.testBankName=this.editForm.name,this.showEditForm=!1,alert("Test bank updated successfully.")}catch(e){console.error("Error updating test bank:",e),alert("Failed to update test bank.")}},async initialize(){await this.fetchQuestions();try{const e=await D.get("/testbanks/"+this.testBankId,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.testBankName=e.data.name,this.editForm.name=e.data.name,this.editForm.chapter=e.data.chapter_number,this.editForm.section=e.data.section_number}catch(e){console.warn("Couldn't load testbank details:",e)}},handleGraphicUpload(e){const t=e.target.files[0];if(!t)return;const o=new FileReader;o.onload=e=>{this.testOptions.graphicFile=t,this.testOptions.graphicFileName=t.name,this.testOptions.graphicPreview=e.target.result},o.readAsDataURL(t)},goToCreateTest(){const e={testName:this.testOptions.testName,selectedTemplate:this.testOptions.selectedTemplate,uploadedImage:this.testOptions.graphicFileName||"",coverPage:this.testOptions.coverPage||!1,graphicPreview:this.testOptions.graphicPreview||""};localStorage.setItem("testOptions",JSON.stringify(e)),this.$router.push({path:"/TeacherTemplate",query:{courseId:this.courseId,courseTitle:this.courseTitle,testBankId:this.testBankId,testBankName:this.testBankName}})}}};o("a968");const Wc=s()(Rc,[["render",Hc],["__scopeId","data-v-5eec377c"]]);var Gc=Wc;const Jc={class:"webmaster-home-container"},Xc={class:"center large-paragraph"};function Kc(e,t,o,c,a,l){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Jc,[t[7]||(t[7]=Object(n["createElementVNode"])("div",{class:"center large-heading"},[Object(n["createElementVNode"])("h1",null,"Database Downloads")],-1)),Object(n["createElementVNode"])("div",Xc,[t[5]||(t[5]=Object(n["createElementVNode"])("p",null,"Select a dataset to download:",-1)),t[6]||(t[6]=Object(n["createElementVNode"])("p",null,"Note: Download All will download each file separately for readability.",-1)),Object(n["createElementVNode"])("button",{class:"button",onClick:t[0]||(t[0]=e=>l.downloadData("users"))},"Download Users"),Object(n["createElementVNode"])("button",{class:"button",onClick:t[1]||(t[1]=e=>l.downloadData("textbook"))},"Download Textbooks"),Object(n["createElementVNode"])("button",{class:"button",onClick:t[2]||(t[2]=e=>l.downloadData("courses"))},"Download Courses"),Object(n["createElementVNode"])("button",{class:"button",onClick:t[3]||(t[3]=e=>l.downloadData("questions"))},"Download Questions"),Object(n["createElementVNode"])("button",{class:"button",onClick:t[4]||(t[4]=e=>l.downloadData("all"))},"Download All")])])}var Yc={name:"WebmasterHome",methods:{async downloadData(e){const t={users:"users",courses:"courses",textbook:"textbook",questions:"questions"};if("all"===e){for(const[e,o]of Object.entries(t))await this.fetchAndDownload(o,e+".csv");return}const o=t[e];o?await this.fetchAndDownload(o,e+".csv"):alert("Unsupported download type: "+e)},async fetchAndDownload(e,t){try{const o=await D.get("/download/"+e,{responseType:"blob"}),n=window.URL.createObjectURL(o.data),c=document.createElement("a");c.href=n,c.download=t,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(n)}catch(o){console.error(`Download error for ${e}:`,o),alert("Failed to download "+t)}}}};o("bc29");const Zc=s()(Yc,[["render",Kc],["__scopeId","data-v-3d983deb"]]);var ea=Zc;const ta={class:"webmaster-log-container"},oa={class:"center large-paragraph"},na=["disabled"],ca={key:0,class:"error-message"},aa={key:1,class:"loading-message"};function la(e,t,o,c,a,l){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ta,[t[14]||(t[14]=Object(n["createElementVNode"])("div",{class:"center large-heading"},[Object(n["createElementVNode"])("h1",null,"Webmaster Login")],-1)),Object(n["createElementVNode"])("div",oa,[t[11]||(t[11]=Object(n["createTextVNode"])(" Please enter your webmaster username and password: ")),t[12]||(t[12]=Object(n["createElementVNode"])("br",null,null,-1)),t[13]||(t[13]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("form",{onSubmit:t[2]||(t[2]=Object(n["withModifiers"])((...e)=>l.submitForm&&l.submitForm(...e),["prevent"]))},[t[3]||(t[3]=Object(n["createElementVNode"])("label",{for:"uname"},"Username:",-1)),t[4]||(t[4]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",id:"uname","onUpdate:modelValue":t[0]||(t[0]=e=>a.username=e)},null,512),[[n["vModelText"],a.username]]),t[5]||(t[5]=Object(n["createElementVNode"])("br",null,null,-1)),t[6]||(t[6]=Object(n["createElementVNode"])("br",null,null,-1)),t[7]||(t[7]=Object(n["createElementVNode"])("label",{for:"pass"},"Password:",-1)),t[8]||(t[8]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"password",id:"pass","onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e)},null,512),[[n["vModelText"],a.password]]),t[9]||(t[9]=Object(n["createElementVNode"])("br",null,null,-1)),t[10]||(t[10]=Object(n["createElementVNode"])("br",null,null,-1)),Object(n["createElementVNode"])("input",{type:"submit",value:"Submit",disabled:a.loading},null,8,na)],32),a.errorMessage?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ca,Object(n["toDisplayString"])(a.errorMessage),1)):Object(n["createCommentVNode"])("",!0),a.loading?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",aa,"Logging in...")):Object(n["createCommentVNode"])("",!0)])])}var ra={data(){return{username:"",password:"",errorMessage:"",loading:!1}},mounted(){const e=localStorage.getItem("token");if(e)try{const t=Object(I["default"])(e),o=Date.now()/1e3;t.exp>o&&"webmaster"===t.role&&this.$router.push("/WebmasterHome")}catch(t){console.error("Invalid token",t)}},methods:{async submitForm(){if(this.username&&this.password)if(this.username.trim().length<3||this.password.trim().length<6)this.errorMessage="Username must be at least 3 characters and password at least 6 characters.";else{this.loading=!0,this.errorMessage="";try{const e=await D.post("/auth/login",{username:this.username.toLowerCase(),password:this.password}),{token:t,user_id:o,role:n}=e.data;localStorage.setItem("token",t),localStorage.setItem("user_id",o),localStorage.setItem("role",n),"webmaster"===n?this.$router.push("/WebmasterHome"):(this.errorMessage="Only webmasters can log in here.",localStorage.clear())}catch(e){e.response?401===e.response.status?this.errorMessage="Invalid username or password.":this.errorMessage=e.response&&e.response.data&&e.response.data.message||"An error occurred during login.":this.errorMessage="Network error. Please check your connection."}finally{this.loading=!1}}else this.errorMessage="Please enter both username and password."}}};o("e06c");const sa=s()(ra,[["render",la],["__scopeId","data-v-63959a83"]]);var ia=sa;const da=[{path:"/",name:"Welcome",component:k},{path:"/PubHome",name:"PubHome",component:M},{path:"/PubLog",name:"PubLog",component:R},{path:"/PubNewBook",name:"PubNewBook",component:ee},{path:"/PubNewTB",name:"PubNewTB",component:ie},{path:"/PubQuestions",name:"PubQuestions",component:Ke},{path:"/PubViewFeedback",name:"PubViewFeedback",component:it},{path:"/PubViewTB",name:"PubViewTB",component:It},{path:"/TeacherHome",name:"TeacherHome",component:Gt},{path:"/TeacherLog",name:"TeacherLog",component:no},{path:"/TeacherNewClass",name:"TeacherNewClass",component:po},{path:"/TeacherNewTB",name:"TeacherNewTB",component:Vo},{path:"/TeacherNewTest",name:"TeacherNewTest",component:Fo},{path:"/TeacherPubQ",name:"TeacherPubQ",component:zo},{path:"/TeacherQuestions",name:"TeacherQuestions",component:Fn},{path:"/TeacherTemplate",name:"TeacherTemplate",component:Vc},{path:"/TeacherViewTB/:id",name:"TeacherViewTB",component:Gc},{path:"/WebmasterHome",name:"WebmasterHome",component:ea},{path:"/WebmasterLog",name:"WebmasterLog",component:ia}],ua=Object(u["a"])({history:Object(u["b"])(),routes:da});var ba=ua;const ma=Object(n["createApp"])(d);ma.use(ba),ma.mount("#app")},"57ef":function(e,t,o){},6229:function(e,t,o){},6271:function(e,t,o){},"687a":function(e,t,o){},"7a00":function(e,t,o){},"7caf":function(e,t,o){"use strict";o("6271")},"7e19":function(e,t,o){},8589:function(e,t,o){"use strict";o("bf8e")},"8bca":function(e,t,o){"use strict";o("4ff5")},"93bd":function(e,t,o){},a86e:function(e,t,o){},a968:function(e,t,o){"use strict";o("e7d1")},aa55:function(e,t,o){},ab80:function(e,t,o){"use strict";o("a86e")},b458:function(e,t,o){},b477:function(e,t,o){},b6e6:function(e,t,o){"use strict";o("c961")},b7ca:function(e,t,o){"use strict";o("e6dc")},bc29:function(e,t,o){"use strict";o("b477")},bf8e:function(e,t,o){},c4f7:function(e,t,o){"use strict";o("b458")},c961:function(e,t,o){},d08e:function(e,t,o){"use strict";o("2143")},d3cc:function(e,t,o){"use strict";o("6229")},e004:function(e,t,o){"use strict";o("93bd")},e06c:function(e,t,o){"use strict";o("156a")},e6dc:function(e,t,o){},e7d1:function(e,t,o){}});
//# sourceMappingURL=app.9f8f2ae8.js.map